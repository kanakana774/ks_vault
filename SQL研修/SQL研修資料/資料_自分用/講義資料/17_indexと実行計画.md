# **SQL åŸºç¤Žï¼šã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¨å®Ÿè¡Œè¨ˆç”»**

## **å°Žå…¥ï¼šãªãœã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¨å®Ÿè¡Œè¨ˆç”»ã‚’å­¦ã¶ã®ã‹ï¼Ÿ**

ã“ã‚Œã¾ã§ã®ç« ã§ SQL ã®åŸºæœ¬çš„ãªãƒ‡ãƒ¼ã‚¿ã®æ“ä½œæ–¹æ³•ã‚„ã€è¤‡é›‘ãªåˆ†æžæ‰‹æ³•ã‚’å­¦ã³ã¾ã—ãŸã€‚ã—ã‹ã—ã€å¤§è¦æ¨¡ãªãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’æ‰±ã†éš›ã€**ã‚¯ã‚¨ãƒªãŒæœŸå¾…é€šã‚Šã®é€Ÿã•ã§å®Ÿè¡Œã•ã‚Œãªã„**ã¨ã„ã†å•é¡Œã«ç›´é¢ã™ã‚‹ã“ã¨ãŒã‚ˆãã‚ã‚Šã¾ã™ã€‚ã“ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹ã®å•é¡Œã‚’è§£æ±ºã—ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’åŠ¹çŽ‡çš„ã«é‹ç”¨ã™ã‚‹ãŸã‚ã«ä¸å¯æ¬ ãªã®ãŒã€Œ**ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹**ã€ã¨ã€Œ**å®Ÿè¡Œè¨ˆç”»**ã€ã®ç†è§£ã§ã™ã€‚

- **ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹**: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒ†ãƒ¼ãƒ–ãƒ«å†…ã§ãƒ‡ãƒ¼ã‚¿ã‚’é«˜é€Ÿã«æ¤œç´¢ã™ã‚‹ãŸã‚ã®ä»•çµ„ã¿ã§ã€æœ¬ã®ç´¢å¼•ï¼ˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼‰ã®ã‚ˆã†ãªã‚‚ã®ã§ã™ã€‚é©åˆ‡ã«åˆ©ç”¨ã™ã‚‹ã“ã¨ã§ã€ãƒ‡ãƒ¼ã‚¿ã®æ¤œç´¢ã‚„ã‚½ãƒ¼ãƒˆå‡¦ç†ã‚’åŠ‡çš„ã«æ”¹å–„ã§ãã¾ã™ã€‚
- **å®Ÿè¡Œè¨ˆç”»**: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  (DBMS) ãŒ SQL ã‚¯ã‚¨ãƒªã‚’å®Ÿè¡Œã™ã‚‹éš›ã«ã€ã©ã®ã‚ˆã†ãªæ‰‹é †ã§ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ãƒ»åŠ å·¥ã™ã‚‹ã‹ã‚’ç¤ºã—ãŸè¨ˆç”»ã§ã™ã€‚ã“ã‚Œã‚’ç¢ºèªã™ã‚‹ã“ã¨ã§ã€ã‚¯ã‚¨ãƒªã®ãƒœãƒˆãƒ«ãƒãƒƒã‚¯ã‚’ç‰¹å®šã—ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹æ”¹å–„ã®ãŸã‚ã®ãƒ’ãƒ³ãƒˆã‚’å¾—ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

æœ¬ç« ã§ã¯ã€ã“ã‚Œã‚‰ã®æ¦‚å¿µã‚’æ·±ãæŽ˜ã‚Šä¸‹ã’ã€å®Ÿè·µçš„ãªãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã®åŸºç¤Žã‚’å­¦ã³ã¾ã™ã€‚

## **ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ (Indexes)**

ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¯ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹ã‚’å‘ä¸Šã•ã›ã‚‹ãŸã‚ã®é‡è¦ãªãƒ„ãƒ¼ãƒ«ã§ã™ã€‚ãƒ†ãƒ¼ãƒ–ãƒ«ã®ç‰¹å®šã®åˆ—ã«ä½œæˆã•ã‚Œã€ãã®åˆ—ã®å€¤ã¨ã€ãã®å€¤ãŒæ ¼ç´ã•ã‚Œã¦ã„ã‚‹è¡Œã®ç‰©ç†çš„ãªä½ç½®ï¼ˆã¾ãŸã¯ãƒ—ãƒ©ã‚¤ãƒžãƒªã‚­ãƒ¼ï¼‰ã‚’çµã³ã¤ã‘ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€DBMS ã¯ãƒ†ãƒ¼ãƒ–ãƒ«å…¨ä½“ã‚’ã‚¹ã‚­ãƒ£ãƒ³ã™ã‚‹ã“ã¨ãªãã€å¿…è¦ãªãƒ‡ãƒ¼ã‚¿ã‚’ç´ æ—©ãè¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ðŸ’¡**ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ä¾‹ãˆ**: åŽšã„æœ¬ã®ç‰¹å®šã®æƒ…å ±ã‚’è¦‹ã¤ã‘ãŸã„ã¨ãã€ãƒšãƒ¼ã‚¸ã®ç«¯ã‹ã‚‰é †ã«è¦‹ã¦ã„ãï¼ˆ**ãƒ†ãƒ¼ãƒ–ãƒ«ã‚¹ã‚­ãƒ£ãƒ³**ï¼‰ã‚ˆã‚Šã‚‚ã€å·»æœ«ã®ç´¢å¼•ï¼ˆ**ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹**ï¼‰ã‚’ä½¿ã£ã¦ç›´æŽ¥ãƒšãƒ¼ã‚¸ã«é£›ã¶æ–¹ãŒã¯ã‚‹ã‹ã«é€Ÿã„ã€ã¨ã„ã†ã‚¤ãƒ¡ãƒ¼ã‚¸ã§ã™ã€‚

### **ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ä½œæˆ**

ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¯ CREATE INDEX æ–‡ã‚’ä½¿ã£ã¦ä½œæˆã—ã¾ã™ã€‚

```SQL
CREATE INDEX ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹å ON ãƒ†ãƒ¼ãƒ–ãƒ«å (åˆ—å [ASC|DESC], ...);
```

### **ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®å†…éƒ¨æ§‹é€ ï¼šB-Tree (B+Tree) ðŸŒ³**

ã»ã¨ã‚“ã©ã® RDBMSï¼ˆPostgreSQL, MySQL, Oracle, SQL Server ãªã©ï¼‰ã§ä½¿ã‚ã‚Œã¦ã„ã‚‹ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ä¸»è¦ãªæ§‹é€ ã¯ã€**B-Tree** ã§ã™ã€‚PostgreSQL ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¯ B-Tree ã§ã™ãŒã€ãã®å†…éƒ¨çš„ãªå®Ÿè£…ã¯**B+Tree ãƒ©ã‚¤ã‚¯**ãªæ§‹é€ ã‚’æŒã£ã¦ã„ã¾ã™ã€‚ã“ã®æ§‹é€ ã‚’ç†è§£ã™ã‚‹ã“ã¨ãŒã€ã€Œãªãœã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒé€Ÿã„ã®ã‹ã€ã€ŒãªãœåŠ¹ã‹ãªã„ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒã‚ã‚‹ã®ã‹ã€ã‚’ç´å¾—ã™ã‚‹éµã¨ãªã‚Šã¾ã™ã€‚

B-Treeï¼ˆB+Treeï¼‰ã¯ã€ãƒ‡ãƒ¼ã‚¿ã‚’ã‚½ãƒ¼ãƒˆã•ã‚ŒãŸçŠ¶æ…‹ã§åŠ¹çŽ‡çš„ã«ä¿å­˜ã—ã€æ¤œç´¢ãƒ»æŒ¿å…¥ãƒ»å‰Šé™¤ã‚’é«˜é€Ÿã«è¡Œã†ãŸã‚ã®è‡ªå·±å¹³è¡¡åž‹ãƒ„ãƒªãƒ¼æ§‹é€ ã§ã™ã€‚ãã®ç‰¹å¾´ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚

1. **éšŽå±¤æ§‹é€ **: ãƒ«ãƒ¼ãƒˆãƒŽãƒ¼ãƒ‰ã‹ã‚‰å§‹ã¾ã‚Šã€æžåˆ†ã‹ã‚Œã—ãªãŒã‚‰ãƒªãƒ¼ãƒ•ãƒŽãƒ¼ãƒ‰ã¸ã¨ãŸã©ã£ã¦ã„ãã¾ã™ã€‚
2. **ã‚½ãƒ¼ãƒˆæ¸ˆã¿**: å„ãƒŽãƒ¼ãƒ‰å†…ã®ã‚­ãƒ¼ï¼ˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹åˆ—ã®å€¤ï¼‰ã¯å¸¸ã«ã‚½ãƒ¼ãƒˆã•ã‚ŒãŸçŠ¶æ…‹ã§ä¿æŒã•ã‚Œã¾ã™ã€‚ã¾ãŸã€è¦ªãƒŽãƒ¼ãƒ‰ã¯å­ãƒŽãƒ¼ãƒ‰ã®æŒã¤ã‚­ãƒ¼ã®ç¯„å›²ã‚’ç¤ºã—ã¾ã™ã€‚
3. **é«˜é€ŸãªæŽ¢ç´¢**: æ¤œç´¢ã—ãŸã„ã‚­ãƒ¼ã¯ã€ãƒ«ãƒ¼ãƒˆãƒŽãƒ¼ãƒ‰ã‹ã‚‰äºŒåˆ†æŽ¢ç´¢ã®ã‚ˆã†ã«è¾¿ã£ã¦ã„ã‘ã°ã€ã™ãã«ç›®çš„ã®ãƒªãƒ¼ãƒ•ãƒŽãƒ¼ãƒ‰ã«åˆ°é”ã§ãã¾ã™ã€‚ãƒ‡ãƒ¼ã‚¿ã®é‡ãŒå¢—ãˆã¦ã‚‚ã€æŽ¢ç´¢ã«ã‹ã‹ã‚‹æ™‚é–“ã¯å¯¾æ•°çš„ã«ã—ã‹å¢—ãˆãªã„ãŸã‚ã€éžå¸¸ã«åŠ¹çŽ‡çš„ã§ã™ï¼ˆä¾‹: 100 ä¸‡ä»¶ã®ãƒ‡ãƒ¼ã‚¿ã§ã‚‚æ•°å›žã®ãƒ‡ã‚£ã‚¹ã‚¯ã‚¢ã‚¯ã‚»ã‚¹ã§ç›®çš„ã®ãƒ‡ãƒ¼ã‚¿ã‚’è¦‹ã¤ã‘ã‚‰ã‚Œã‚‹ï¼‰ã€‚
4. **ãƒªãƒ¼ãƒ•ãƒŽãƒ¼ãƒ‰**: ãƒ‡ãƒ¼ã‚¿ã®æœ¬ä½“ï¼ˆãƒ†ãƒ¼ãƒ–ãƒ«ã®è¡Œï¼‰ã¸ã®ãƒã‚¤ãƒ³ã‚¿ï¼ˆç‰©ç†ã‚¢ãƒ‰ãƒ¬ã‚¹ã€ã¾ãŸã¯ãƒ—ãƒ©ã‚¤ãƒžãƒªã‚­ãƒ¼ï¼‰ã‚’ä¿æŒã—ã¦ã„ã¾ã™ã€‚B+Tree ãƒ©ã‚¤ã‚¯ãªå®Ÿè£…ã®å ´åˆã€å…¨ã¦ã®ã‚­ãƒ¼ã¨ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ã‚¿ï¼ˆã¾ãŸã¯ãƒ‡ãƒ¼ã‚¿è‡ªä½“ï¼‰ãŒãƒªãƒ¼ãƒ•ãƒŽãƒ¼ãƒ‰ã«ã‚ã‚Šã€ãƒªãƒ¼ãƒ•ãƒŽãƒ¼ãƒ‰åŒå£«ã¯åŒæ–¹å‘ãƒªã‚¹ãƒˆã§ã¤ãªãŒã£ã¦ã„ã‚‹ãŸã‚ã€ç¯„å›²æ¤œç´¢ã‚„é †åºæ¤œç´¢ã‚‚é«˜é€Ÿã«è¡Œãˆã¾ã™ã€‚

ã¤ã¾ã‚Šã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¯**ç‰¹å®šã®å€¤ã‹ã‚‰ã€ãã‚ŒãŒæ ¼ç´ã•ã‚Œã¦ã„ã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«ã®å ´æ‰€ã‚’é«˜é€Ÿã«æŽ¢ã—å‡ºã™ãŸã‚ã®ã€Œã‚½ãƒ¼ãƒˆã•ã‚ŒãŸåœ°å›³å¸³ã€**ã®ã‚ˆã†ãªã‚‚ã®ã ã¨æ€ã£ã¦ãã ã•ã„ã€‚

### **ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ç¨®é¡žã¨ B-Tree ã®æŒ™å‹•**

#### **1. å˜ä¸€åˆ—ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ (Single-Column Index)**

1 ã¤ã®åˆ—ã«å¯¾ã—ã¦ä½œæˆã•ã‚Œã‚‹æœ€ã‚‚åŸºæœ¬çš„ãªã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã§ã™ã€‚

B-Tree ã®æŒ™å‹•:  
B-Tree ã®ã‚­ãƒ¼ãŒ 1 ã¤ã®åˆ—ã®å€¤ã§æ§‹æˆã•ã‚Œã¾ã™ã€‚ä¾‹ãˆã° products ãƒ†ãƒ¼ãƒ–ãƒ«ã® product_name åˆ—ã«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½œæˆã—ãŸå ´åˆã€B-Tree ã¯ product_name ã®å€¤ã‚’ã‚­ãƒ¼ã¨ã—ã¦ã‚½ãƒ¼ãƒˆã•ã‚ŒãŸçŠ¶æ…‹ã«ãªã‚Šã¾ã™ã€‚  
**ç‰¹å¾´**:

- ç‰¹å®šã® 1 åˆ—ã®ã¿ã§æ¤œç´¢æ¡ä»¶ï¼ˆWHERE å¥ï¼‰ã‚„ã‚½ãƒ¼ãƒˆæ¡ä»¶ï¼ˆORDER BY å¥ï¼‰ã‚’æŒ‡å®šã™ã‚‹å ´åˆã«ã€B-Tree ã®é«˜é€ŸãªæŽ¢ç´¢èƒ½åŠ›ã‚’ãƒ•ãƒ«æ´»ç”¨ã§ãã¾ã™ã€‚
- æœ€ã‚‚ã‚·ãƒ³ãƒ—ãƒ«ã§ä½œæˆã—ã‚„ã™ã„ã§ã™ãŒã€è¤‡æ•°ã®æ¡ä»¶ã‚’çµ„ã¿åˆã‚ã›ãŸè¤‡é›‘ãªã‚¯ã‚¨ãƒªã§ã¯åŠ¹æžœãŒé™å®šã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚

**ä¾‹**: products ãƒ†ãƒ¼ãƒ–ãƒ«ã® product_name åˆ—ã«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½œæˆã—ã¾ã™ã€‚

**äº‹å‰ãƒ‡ãƒ¼ã‚¿:**

products ãƒ†ãƒ¼ãƒ–ãƒ«:

| product_id | product_name | price   | stock_quantity |
| :--------- | :----------- | :------ | :------------- |
| 1          | Laptop       | 1200.00 | 50             |
| 2          | Mouse        | 25.50   | 20             |
| 3          | Keyboard     | 75.00   | 30             |
| ...        | ...          | ...     | ...            |

**SQL:**

```SQL
-- product_name åˆ—ã«å˜ä¸€åˆ—ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½œæˆ
CREATE INDEX idx_product_name ON products (product_name);
```

ã“ã‚Œã«ã‚ˆã‚Šã€WHERE product_name = 'Laptop'ã®ã‚ˆã†ãªã‚¯ã‚¨ãƒªã¯ã€B-Tree ã‚’è¾¿ã£ã¦ã€ŒLaptopã€ãŒã©ã“ã«ã‚ã‚‹ã‹ã‚’ç´ æ—©ãè¦‹ã¤ã‘ã€å¯¾å¿œã™ã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«ã®è¡Œã‚’èª­ã¿è¾¼ã‚€ã“ã¨ã§é«˜é€ŸåŒ–ã•ã‚Œã¾ã™ã€‚

#### **2. è¤‡åˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ (Composite Index)**

è¤‡æ•°ã®åˆ—ã‚’çµ„ã¿åˆã‚ã›ã¦ä½œæˆã•ã‚Œã‚‹ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã§ã™ã€‚åˆ—ã®é †åºãŒéžå¸¸ã«é‡è¦ã«ãªã‚Šã¾ã™ã€‚

B-Tree ã®æŒ™å‹•:  
B-Tree ã®ã‚­ãƒ¼ãŒè¤‡æ•°ã®åˆ—ã®å€¤ã®çµ„ã¿åˆã‚ã›ã§æ§‹æˆã•ã‚Œã¾ã™ã€‚ã“ã‚Œã‚‰ã®ã‚­ãƒ¼ã¯ã€æŒ‡å®šã•ã‚ŒãŸåˆ—ã®é †åºã«å¾“ã£ã¦ã€Œè¾žæ›¸é †ã€ã«ã‚½ãƒ¼ãƒˆã•ã‚Œã¾ã™ã€‚ä¾‹ãˆã°ã€(category_id, price)ã¨ã„ã†è¤‡åˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®å ´åˆã€ã¾ãš category_id ã§ã‚½ãƒ¼ãƒˆã•ã‚Œã€category_id ãŒåŒã˜ã§ã‚ã‚Œã°æ¬¡ã« price ã§ã‚½ãƒ¼ãƒˆã•ã‚Œã¾ã™ã€‚  
**ç‰¹å¾´**:

- è¤‡æ•°ã®åˆ—ã‚’ AND æ¡ä»¶ã§æ¤œç´¢ã™ã‚‹å ´åˆã‚„ã€ã‚½ãƒ¼ãƒˆæ¡ä»¶ãŒè¤‡æ•°åˆ—ã«ã¾ãŸãŒã‚‹å ´åˆã«åŠ¹æžœçš„ã§ã™ã€‚
- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã«å«ã‚ã‚‹åˆ—ã®é †åºï¼ˆä¾‹: (A, B)ã¨(B, A)ã¯ B-Tree ã®ã‚½ãƒ¼ãƒˆé †ãŒç•°ãªã‚‹ãŸã‚ã€ç•°ãªã‚‹ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼‰ãŒãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹ã«å¤§ããå½±éŸ¿ã—ã¾ã™ã€‚ä¸€èˆ¬çš„ã«ã¯ã€WHERE å¥ã§ã‚ˆã‚Šé »ç¹ã«çµžã‚Šè¾¼ã‚€åˆ—ã‚’å…ˆé ­ã«ã€æ¬¡ã«çµžã‚Šè¾¼ã‚€åˆ—ã‚’é…ç½®ã—ã¾ã™ã€‚
- è¤‡åˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹(A, B, C)ã¯ã€B-Tree ã®æ€§è³ªä¸Šã€(A)ã€(A, B)ã¨ã„ã£ãŸ**å…ˆé ­ã‹ã‚‰ã®åˆ—ã®çµ„ã¿åˆã‚ã›ï¼ˆå·¦å´ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ï¼‰**ã§ã®æ¤œç´¢æ¡ä»¶ã§ã‚‚åˆ©ç”¨ã•ã‚Œã¾ã™ã€‚ã—ã‹ã—ã€(B, C)ã‚„(C)ã®ã¿ã®æ¤œç´¢ã§ã¯ã€B-Tree ã®å…ˆé ­ã‚­ãƒ¼ãŒ B ã‚„ C ã§ã¯ãªã„ãŸã‚ã€åŠ¹çŽ‡çš„ã«åˆ©ç”¨ã•ã‚Œã¾ã›ã‚“ã€‚ã“ã‚Œã¯ã€Œè¾žæ›¸ã§æœ€åˆã®æ–‡å­—ã—ã‹çŸ¥ã‚‰ãªã„ã®ã«ã€çœŸã‚“ä¸­ã®æ–‡å­—ã§æŽ¢ã™ã‚ˆã†ãªã‚‚ã®ã€ã§ã™ã€‚

**ä¾‹**: products ãƒ†ãƒ¼ãƒ–ãƒ«ã§ category_id ã¨ price ã‚’çµ„ã¿åˆã‚ã›ã¦æ¤œç´¢ã™ã‚‹æ©Ÿä¼šãŒå¤šã„å ´åˆã€‚

**äº‹å‰ãƒ‡ãƒ¼ã‚¿:**

products ãƒ†ãƒ¼ãƒ–ãƒ«:

| product_id | product_name | price   | stock_quantity | category_id |
| :--------- | :----------- | :------ | :------------- | :---------- |
| 1          | Laptop       | 1200.00 | 50             | 1           |
| 2          | Mouse        | 25.50   | 20             | 1           |
| 3          | Keyboard     | 75.00   | 30             | 2           |
| ...        | ...          | ...     | ...            | ...         |

**SQL:**

```SQL
-- category_id ã¨ price åˆ—ã®è¤‡åˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½œæˆ
-- category_id ã§çµžã‚Šè¾¼ã¿ã€ãã®å¾Œ price ã§çµžã‚Šè¾¼ã‚€ã‚¯ã‚¨ãƒªã«åŠ¹æžœçš„
CREATE INDEX idx_category_price ON products (category_id, price DESC);
```

ã“ã‚Œã«ã‚ˆã‚Šã€WHERE category_id = 1 AND price > 100 ã®ã‚ˆã†ãªã‚¯ã‚¨ãƒªã¯ã€ã¾ãš B-Tree ã® category_id ã§ 1 ã®ç¯„å›²ã‚’æŽ¢ã—ã€ãã®ä¸­ã§ price ãŒ 100 ã‚ˆã‚Šå¤§ãã„éƒ¨åˆ†ã‚’åŠ¹çŽ‡çš„ã«è¦‹ã¤ã‘ã‚‹ãŸã‚ã€é«˜é€ŸåŒ–ã•ã‚Œã¾ã™ã€‚

#### **3. ã‚«ãƒãƒªãƒ³ã‚°ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ (Covering Index / Index-Only Scan)**

ã‚¯ã‚¨ãƒªãŒè¦æ±‚ã™ã‚‹å…¨ã¦ã®åˆ—ãŒã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹è‡ªä½“ã«å«ã¾ã‚Œã¦ã„ã‚‹ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã§ã™ã€‚DBMS ã¯ãƒ†ãƒ¼ãƒ–ãƒ«æœ¬ä½“ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ãªãã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ã¿ã§å¿…è¦ãªæƒ…å ±ã‚’å–å¾—ã§ãã‚‹ãŸã‚ã€I/O ã‚³ã‚¹ãƒˆã‚’å¤§å¹…ã«å‰Šæ¸›ã—ã€éžå¸¸ã«é«˜ã„ãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹ã‚’ç™ºæ®ã—ã¾ã™ã€‚

B-Tree ã®æŒ™å‹•:
é€šå¸¸ã€B-Tree ã®ãƒªãƒ¼ãƒ•ãƒŽãƒ¼ãƒ‰ã«ã¯ã‚­ãƒ¼å€¤ã¨ãƒ†ãƒ¼ãƒ–ãƒ«æœ¬ä½“ã¸ã®ãƒã‚¤ãƒ³ã‚¿ãŒæ ¼ç´ã•ã‚Œã¾ã™ã€‚ã—ã‹ã—ã€ã‚«ãƒãƒªãƒ³ã‚°ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®å ´åˆã€SELECT å¥ã§è¦æ±‚ã•ã‚Œã‚‹è¿½åŠ ã®åˆ—ã‚‚ãƒªãƒ¼ãƒ•ãƒŽãƒ¼ãƒ‰ã«æ ¼ç´ã•ã‚Œã¾ã™ï¼ˆPostgreSQL ã® INCLUDE å¥ã¯ãã®ä¸€ä¾‹ã§ã™ï¼‰ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€DBMS ã¯ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã® B-Tree ã‚’è¾¿ã‚‹ã ã‘ã§ã€å¿…è¦ãªå…¨ã¦ã®ãƒ‡ãƒ¼ã‚¿ãŒå¾—ã‚‰ã‚Œã€ãƒ‡ãƒ¼ã‚¿ãŒæ ¼ç´ã•ã‚Œã¦ã„ã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«æœ¬ä½“ï¼ˆãƒ’ãƒ¼ãƒ—é ˜åŸŸãªã©ï¼‰ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ãŒä¸è¦ã«ãªã‚Šã¾ã™ã€‚ã“ã®ãƒ†ãƒ¼ãƒ–ãƒ«æœ¬ä½“ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’ã€Œãƒ–ãƒƒã‚¯ãƒžãƒ¼ã‚¯ãƒ«ãƒƒã‚¯ã‚¢ãƒƒãƒ—ã€ã‚„ã€Œãƒ’ãƒ¼ãƒ—ã‚¢ã‚¯ã‚»ã‚¹ã€ã¨å‘¼ã³ã¾ã™ãŒã€ã‚«ãƒãƒªãƒ³ã‚°ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¯ã“ã‚Œã‚’å›žé¿ã—ã¾ã™ã€‚
**ç‰¹å¾´**:

- SELECT å¥ã§æŒ‡å®šã™ã‚‹åˆ—ãŒå…¨ã¦ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã«å«ã¾ã‚Œã‚‹å ´åˆã«æ©Ÿèƒ½ã—ã¾ã™ã€‚
- ãƒ†ãƒ¼ãƒ–ãƒ«æœ¬ä½“ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ï¼ˆãƒ‡ã‚£ã‚¹ã‚¯ I/Oï¼‰ãŒãªããªã‚‹ãŸã‚ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹ãŒåŠ‡çš„ã«å‘ä¸Šã—ã¾ã™ã€‚
- ãŸã ã—ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚µã‚¤ã‚ºãŒå¤§ãããªã‚Šã€ãƒ‡ãƒ¼ã‚¿æŒ¿å…¥ãƒ»æ›´æ–°ãƒ»å‰Šé™¤æ™‚ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰ãŒå¢—åŠ ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

PostgreSQL ã«ãŠã‘ã‚‹ Index Only Scan ã®æ³¨æ„ç‚¹:
PostgreSQL ã§ Index Only Scan ãŒåˆ©ç”¨ã•ã‚Œã‚‹ãŸã‚ã«ã¯ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒã‚«ãƒãƒ¼ã™ã‚‹åˆ—ã ã‘ã§ãªãã€å¯¾è±¡ã®ãƒ†ãƒ¼ãƒ–ãƒ«è¡ŒãŒã€Œã™ã§ã«å¯è¦–ï¼ˆvisibleï¼‰ã€ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã¯ã€PostgreSQL ã® MVCCï¼ˆå¤šç‰ˆåž‹åŒæ™‚å®Ÿè¡Œåˆ¶å¾¡ï¼‰ã®ä»•çµ„ã¿ä¸Šã€å¤ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®è¡Œã‚’å‚ç…§ã—ãªã„ã“ã¨ã‚’ä¿è¨¼ã™ã‚‹ãŸã‚ã§ã™ã€‚
ã‚‚ã— VACUUM ã‚„ Autovacuum ãŒé©åˆ‡ã«å‹•ä½œã—ã¦ã„ãªã„ã¨ã€ãƒ†ãƒ¼ãƒ–ãƒ«ã«å¤ã„è¡Œãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒæ®‹ã‚Šã€Index Only Scan ãŒä½¿ã‚ã‚Œãšã€çµå±€ãƒ†ãƒ¼ãƒ–ãƒ«æœ¬ä½“ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ï¼ˆHeap Fetchï¼‰ãŒå¿…è¦ã«ãªã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ã—ãŸãŒã£ã¦ã€Index Only Scan ã¯å¿…ãšã—ã‚‚ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã ã‘ã§æ¸ˆã‚€ã‚ã‘ã§ã¯ãªã„ã“ã¨ã‚’è¦šãˆã¦ãŠãã¾ã—ã‚‡ã†ã€‚
**ä¾‹**: products ãƒ†ãƒ¼ãƒ–ãƒ«ã§ category_id ã¨ price ã‚’æ¤œç´¢æ¡ä»¶ã¨ã—ã€product_name ã‚‚çµæžœã¨ã—ã¦å–å¾—ã—ãŸã„å ´åˆã€‚

**SQL:**

```SQL
-- category_id ã‚’ã‚­ãƒ¼ã¨ã—ã€price ã¨ product_name ã‚’ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã«å«ã‚ã‚‹ (PostgreSQL ã® INCLUDE å¥ã®ä¾‹)
CREATE INDEX idx_category_price_name ON products (category_id) INCLUDE (price, product_name);
```

SELECT product_name, price FROM products WHERE category_id = 1 AND price > 100` ã®ã‚ˆã†ãªã‚¯ã‚¨ãƒªã¯ã€ã“ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒã‚ã‚Œã°ãƒ†ãƒ¼ãƒ–ãƒ«æœ¬ä½“ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ãªã—ã§å®Ÿè¡Œã§ãã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚å®Ÿè¡Œè¨ˆç”»ã§ã¯ã€ŒIndex Only Scanã€ã¨è¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ãŒå¤šã„ã§ã—ã‚‡ã†ã€‚

### ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒåŠ¹ã‹ãªã„ãƒ‘ã‚¿ãƒ¼ãƒ³ (ãªãœåŠ¹ã‹ãªã„ã®ã‹ï¼Ÿ)

ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¯ä¸‡èƒ½ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚B-Tree ã®æ§‹é€ ã¨æŽ¢ç´¢åŽŸç†ã‚’ç†è§£ã—ã¦ã„ã‚Œã°ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒåˆ©ç”¨ã•ã‚Œãªã„ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚‚ç´å¾—ã§ãã¾ã™ã€‚

#### 1. ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰å‰æ–¹ä¸€è‡´ä»¥å¤– (`%`ãŒå…ˆé ­ã«æ¥ã‚‹å ´åˆ)

`LIKE`å¥ã§æ¤œç´¢æ¡ä»¶ã®å…ˆé ­ã«ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰`%`ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¯åˆ©ç”¨ã•ã‚Œã¾ã›ã‚“ã€‚

**SQL (ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒåŠ¹ã‹ãªã„):**

```sql
-- ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰ãŒå…ˆé ­ã«ã‚ã‚‹ãŸã‚ã€idx_product_name ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¯åˆ©ç”¨ã•ã‚Œãªã„
SELECT product_name FROM products WHERE product_name LIKE '%Mouse%';
```

##### ãªãœåŠ¹ã‹ãªã„ã®ã‹:

B-Tree ã¯ã‚­ãƒ¼ã®ã‚½ãƒ¼ãƒˆé †ã«åŸºã¥ã„ã¦ãƒ‡ãƒ¼ã‚¿ã‚’æŽ¢ç´¢ã—ã¾ã™ã€‚ã‚­ãƒ¼ã®å…ˆé ­éƒ¨åˆ†ãŒåˆ†ã‹ã£ã¦ã„ã‚Œã°ã€ãƒ„ãƒªãƒ¼ã‚’è¾¿ã£ã¦åŠ¹çŽ‡çš„ã«è©²å½“ç¯„å›²ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼ˆä¾‹: 'Mouse%'ã§ã‚ã‚Œã°ã€ŒMã€ã‹ã‚‰å§‹ã¾ã‚‹ç¯„å›²ã‚’æŽ¢ã›ã‚‹ï¼‰ã€‚
ã—ã‹ã—ã€'%Mouse%'ã®ã‚ˆã†ã«å…ˆé ­ãŒãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰ã®å ´åˆã€ã€ŒMã€ãŒã©ã“ã‹ã‚‰å§‹ã¾ã‚‹ã®ã‹ã€ã‚ã‚‹ã„ã¯ã€ŒMouseã€ã‚’å«ã‚€æ–‡å­—åˆ—ãŒã©ã“ã«ã‚ã‚‹ã®ã‹ã‚’ B-Tree ã¯åŠ¹çŽ‡çš„ã«åˆ¤æ–­ã§ãã¾ã›ã‚“ã€‚ã“ã‚Œã¯ã€**ã€Œå·»æœ«ã®ç´¢å¼•ã§ã€å˜èªžã®é€”ä¸­ã«ã—ã‹åˆ†ã‹ã‚‰ãªã„éƒ¨åˆ†ã—ã‹ãªã„ã®ã«ã€ç´¢å¼•ã‚’å¼•ãã“ã¨ãŒã§ããªã„ã€**ã®ã¨åŒã˜çŠ¶æ³ã§ã™ã€‚çµå±€ã€DBMS ã¯ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½¿ã‚ãšã€ãƒ†ãƒ¼ãƒ–ãƒ«ã®å…¨è¡Œã‚’ç‰©ç†çš„ã«èª­ã¿è¾¼ã‚“ã§ï¼ˆã‚·ãƒ¼ã‚±ãƒ³ã‚·ãƒ£ãƒ«ã‚¹ã‚­ãƒ£ãƒ³ï¼‰ã€å„è¡Œã® product_name ã‚’ä¸€ã¤ãšã¤ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã—ã‹ãªããªã‚Šã¾ã™ã€‚

**å¯¾ç­–**:

- å¯èƒ½ã§ã‚ã‚Œã°ã€ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰ã‚’å…ˆé ­ã«ç½®ã‹ãªã„æ¤œç´¢æ¡ä»¶ã«ã™ã‚‹ï¼ˆä¾‹: LIKE 'Mouse%'ï¼‰ã€‚
- **å…¨æ–‡æ¤œç´¢æ©Ÿèƒ½**ï¼ˆPostgreSQL ã® tsvector ãªã©ï¼‰ã®åˆ©ç”¨ã‚’æ¤œè¨Žã™ã‚‹ã€‚å…¨æ–‡æ¤œç´¢ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¯ã€ãƒ†ã‚­ã‚¹ãƒˆã®å˜èªžå˜ä½ã§ã®æ¤œç´¢ã«ç‰¹åŒ–ã—ãŸåˆ¥ã®æ§‹é€ ã‚’æŒã£ã¦ã„ã¾ã™ã€‚
- **æ¼”ç®—å­ã‚¯ãƒ©ã‚¹ã®æŒ‡å®š**ï¼ˆPostgreSQLï¼‰: text_pattern_ops ã‚„ varchar_pattern_ops ã¨ã„ã£ãŸæ¼”ç®—å­ã‚¯ãƒ©ã‚¹ã‚’ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä½œæˆæ™‚ã«æŒ‡å®šã™ã‚‹ã“ã¨ã§ã€LIKE 'abc%'ã®ã‚ˆã†ãªå‰æ–¹ä¸€è‡´æ¤œç´¢ã ã‘ã§ãªãã€æ­£è¦è¡¨ç¾(~)ã®å…ˆé ­éƒ¨åˆ†ä¸€è‡´ãªã©ã®ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œç´¢ã§ã‚‚ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’åˆ©ç”¨ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

```SQL
  -- text_pattern_ops ã‚’æŒ‡å®šã—ãŸã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ä¾‹ (LIKE 'abc%' ã§ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒåŠ¹ã)
  CREATE INDEX idx_product_name_pattern ON products (product_name text_pattern_ops);

  -- ã—ã‹ã—ã€'%abc' ã‚„ '%abc%' ã®å ´åˆã¯ä¾ç„¶ã¨ã—ã¦ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¯åŠ¹ã‹ãªã„
```

#### **2. åˆ—ã«é–¢æ•°ã‚’é©ç”¨ã—ãŸå ´åˆ**

WHERE å¥ã§ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹å¯¾è±¡ã®åˆ—ã«ä½•ã‚‰ã‹ã®é–¢æ•°ï¼ˆLOWER(), SUBSTRING(), DATE()ãªã©ï¼‰ã‚’é©ç”¨ã™ã‚‹ã¨ã€DBMS ã¯ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’åˆ©ç”¨ã§ããªããªã‚Šã¾ã™ã€‚

**SQL (ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒåŠ¹ã‹ãªã„):**

```SQL
-- product_name åˆ—ã« LOWER é–¢æ•°ã‚’é©ç”¨ã—ã¦ã„ã‚‹ãŸã‚ã€idx_product_name ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¯åˆ©ç”¨ã•ã‚Œãªã„
SELECT product_name FROM products WHERE LOWER(product_name) = 'laptop';
```

###### ãªãœåŠ¹ã‹ãªã„ã®ã‹:

B-Tree ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¯ã€å…ƒã®åˆ—ã®å€¤ã«åŸºã¥ã„ã¦ã‚­ãƒ¼ã‚’ä½œæˆã—ã€ã‚½ãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚
LOWER(product_name)ã®ã‚ˆã†ã«åˆ—ã«åŠ å·¥ãŒåŠ ãˆã‚‰ã‚Œã‚‹ã¨ã€æ¤œç´¢ã—ãŸã„å€¤'laptop'ã¯é–¢æ•°ãŒé©ç”¨ã•ã‚ŒãŸçµæžœã®å€¤ã§ã‚ã‚Šã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã«æ ¼ç´ã•ã‚Œã¦ã„ã‚‹å…ƒã® product_name ã®å€¤ï¼ˆä¾‹: 'Laptop', 'LAPTOP'ï¼‰ã¨ã¯ç›´æŽ¥ä¸€è‡´ã—ã¾ã›ã‚“ã€‚
DBMS ã¯ã€æ¤œç´¢æ¡ä»¶ LOWER(product_name) = 'laptop'ã‚’æº€ãŸã™è¡Œã‚’æŽ¢ã™ãŸã‚ã«ã€ãƒ†ãƒ¼ãƒ–ãƒ«ã®å…¨è¡Œã‚’èª­ã¿è¾¼ã¿ã€ãã‚Œãžã‚Œã® product_name ã« LOWER()é–¢æ•°ã‚’é©ç”¨ã—ã€ãã®çµæžœãŒ'laptop'ã¨ä¸€è‡´ã™ã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã™ã‚‹ã—ã‹ãªããªã‚Šã¾ã™ã€‚ã“ã‚Œã¯ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®åˆ©ç‚¹ã‚’å®Œå…¨ã«æ‰“ã¡æ¶ˆã—ã¦ã—ã¾ã„ã¾ã™ã€‚

**å¯¾ç­–**:

- å¯èƒ½ã§ã‚ã‚Œã°ã€é–¢æ•°ã‚’é©ç”¨ã›ãšã«æ¤œç´¢ã§ãã‚‹å½¢ã«ã™ã‚‹ï¼ˆä¾‹: product_name = 'Laptop'ã€‚ãŸã ã—ã€å¤§æ–‡å­—ãƒ»å°æ–‡å­—ã‚’åŒºåˆ¥ã™ã‚‹å ´åˆã¯æ³¨æ„ï¼‰ã€‚
- **é–¢æ•°ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼ˆãƒ•ã‚¡ãƒ³ã‚¯ã‚·ãƒ§ãƒ³ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼‰** ã®åˆ©ç”¨ã‚’æ¤œè¨Žã™ã‚‹ã€‚ç‰¹å®šã® RDBMSï¼ˆPostgreSQL, Oracle ãªã©ï¼‰ã§ã¯ã€

```SQL
CREATE INDEX idx_lower_product_name ON products (LOWER(product_name));
```

ã®ã‚ˆã†ã«ã€é–¢æ•°é©ç”¨å¾Œã®å€¤ã‚’åŸºã«ã—ãŸã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½œæˆã§ãã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€WHERE LOWER(product_name) = 'laptop'ã®ã‚ˆã†ãªã‚¯ã‚¨ãƒªã§ã‚‚ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒåˆ©ç”¨å¯èƒ½ã«ãªã‚Šã¾ã™ã€‚

#### **ãã®ä»–ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒåŠ¹ã‹ãªã„ï¼ˆåŠ¹ãã«ãã„ï¼‰ãƒ‘ã‚¿ãƒ¼ãƒ³**

- **ãƒ‡ãƒ¼ã‚¿åž‹ä¸ä¸€è‡´**: æ¯”è¼ƒã™ã‚‹åˆ—ã¨å€¤ã®ãƒ‡ãƒ¼ã‚¿åž‹ãŒç•°ãªã‚‹ã¨ã€DBMS ãŒå†…éƒ¨çš„ã«åž‹å¤‰æ›ã‚’è¡Œã†å¿…è¦ãŒã‚ã‚Šã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒåˆ©ç”¨ã•ã‚Œãªã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚DBMS ãŒã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚­ãƒ¼ã‚’æ¤œç´¢æ¡ä»¶ã¨æ¯”è¼ƒã™ã‚‹éš›ã€åž‹å¤‰æ›ãŒå…¥ã‚‹ã¨ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ã‚½ãƒ¼ãƒˆé †ãŒä¿è¨¼ã•ã‚Œãªããªã‚‹ãŸã‚ã§ã™ã€‚
- **OR æ¡ä»¶**: è¤‡æ•°ã®ç•°ãªã‚‹åˆ—ã« OR æ¡ä»¶ã‚’ä½¿ç”¨ã—ãŸå ´åˆã€ãã‚Œãžã‚Œã®æ¡ä»¶ã«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒã‚ã£ã¦ã‚‚è¤‡åˆçš„ã«åˆ©ç”¨ã•ã‚Œã«ãã„ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ä¾‹ãˆã° WHERE A = 1 OR B = 2 ã®å ´åˆã€A ã¨ B ãã‚Œãžã‚Œã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’åˆ¥ã€…ã«ã‚¹ã‚­ãƒ£ãƒ³ã—ã€çµæžœã‚’çµåˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ãŒã€ã“ã®å‡¦ç†ãŒã‚·ãƒ¼ã‚±ãƒ³ã‚·ãƒ£ãƒ«ã‚¹ã‚­ãƒ£ãƒ³ã‚ˆã‚Šã‚‚é«˜ã‚³ã‚¹ãƒˆã¨åˆ¤æ–­ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚
- **NOT IN / NOT EXISTS**: å¦å®šæ¡ä»¶ã¯ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒåˆ©ç”¨ã•ã‚Œã«ãã„å‚¾å‘ãŒã‚ã‚Šã¾ã™ã€‚ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¯ã€Œã‚ã‚‹å€¤ãŒå­˜åœ¨ã™ã‚‹å ´æ‰€ã€ã‚’ç‰¹å®šã™ã‚‹ã®ã«å„ªã‚Œã¦ã„ã¾ã™ãŒã€ã€Œã‚ã‚‹å€¤ãŒå­˜åœ¨ã—ãªã„å ´æ‰€ã€ã‚’ç‰¹å®šã™ã‚‹ã®ã¯è‹¦æ‰‹ã§ã™ã€‚
- **ã‚«ãƒ¼ãƒ‡ã‚£ãƒŠãƒªãƒ†ã‚£ã®ä½Žã„åˆ—**: ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªå€¤ãŒéžå¸¸ã«å°‘ãªã„åˆ—ï¼ˆä¾‹: æ€§åˆ¥ã€ãƒ•ãƒ©ã‚°ï¼‰ã«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½œæˆã—ã¦ã‚‚ã€çµžã‚Šè¾¼ã¿åŠ¹æžœãŒä½Žã„ãŸã‚ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½¿ã†ã‚ˆã‚Šã‚‚ãƒ†ãƒ¼ãƒ–ãƒ«ã‚¹ã‚­ãƒ£ãƒ³ã®æ–¹ãŒé«˜é€Ÿã¨åˆ¤æ–­ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ä¾‹ãˆã°ã€100 ä¸‡ä»¶ã®ãƒ‡ãƒ¼ã‚¿ã§ã€Œæ€§åˆ¥ = 'ç”·æ€§'ã€ã‚’æ¤œç´¢ã™ã‚‹å ´åˆã€50 ä¸‡ä»¶ã®è¡ŒãŒè©²å½“ã™ã‚‹ãªã‚‰ã€B-Tree ã‚’è¾¿ã£ã¦ 50 ä¸‡ä»¶ã®ãƒã‚¤ãƒ³ã‚¿ã‚’å–å¾—ã—ã€50 ä¸‡å›žã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚¢ã‚¯ã‚»ã‚¹ã‚’ã™ã‚‹ã‚ˆã‚Šã‚‚ã€ã„ã£ãå…¨ä»¶ã‚¹ã‚­ãƒ£ãƒ³ã—ã¦ 50 ä¸‡ä»¶ã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã™ã‚‹æ–¹ãŒé€Ÿã„ã€ã¨ã‚ªãƒ—ãƒ†ã‚£ãƒžã‚¤ã‚¶ãŒåˆ¤æ–­ã™ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚
- **IS NULL / IS NOT NULL**: PostgreSQL ã§ã¯ NULL å€¤ã‚‚ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã«æ ¼ç´ã•ã‚Œã¾ã™ã€‚ã—ãŸãŒã£ã¦ã€WHERE column IS NULL ã‚„ WHERE column IS NOT NULL ã¨ã„ã†æ¡ä»¶ã§ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒåˆ©ç”¨ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ã—ã‹ã—ã€NULL å€¤ã®å‰²åˆãŒå¤šã„å ´åˆï¼ˆã‚«ãƒ¼ãƒ‡ã‚£ãƒŠãƒªãƒ†ã‚£ãŒä½Žã„å ´åˆï¼‰ã‚„ã€ä»–ã®æ¡ä»¶ã¨ã®çµ„ã¿åˆã‚ã›ã«ã‚ˆã£ã¦ã¯ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚¹ã‚­ãƒ£ãƒ³ã‚ˆã‚Šã‚‚ã‚·ãƒ¼ã‚±ãƒ³ã‚·ãƒ£ãƒ«ã‚¹ã‚­ãƒ£ãƒ³ã®æ–¹ãŒåŠ¹çŽ‡çš„ã¨åˆ¤æ–­ã•ã‚Œã‚‹ã“ã¨ã‚‚ã‚ã‚Šã¾ã™ã€‚

### **ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ (ãªãœé—‡é›²ã«å¢—ã‚„ã—ã¦ã¯ã„ã‘ãªã„ã®ã‹ï¼Ÿ)**

ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¯ãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹å‘ä¸Šã«è²¢çŒ®ã—ã¾ã™ãŒã€ãƒ‡ãƒ¡ãƒªãƒƒãƒˆã‚‚å­˜åœ¨ã—ã¾ã™ã€‚ã“ã‚Œã‚’ç†è§£ã›ãšé—‡é›²ã«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’å¢—ã‚„ã™ã¨ã€ã‹ãˆã£ã¦æ€§èƒ½ã‚’æ‚ªåŒ–ã•ã›ã‚‹åŽŸå› ã«ãªã‚Šã¾ã™ã€‚

1. æ›¸ãè¾¼ã¿æ€§èƒ½ã®ä½Žä¸‹ (Write Overhead):
   INSERTã€UPDATEã€DELETE ã¨ã„ã£ãŸãƒ‡ãƒ¼ã‚¿å¤‰æ›´æ“ä½œãŒè¡Œã‚ã‚Œã‚‹ãŸã³ã«ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¯ãƒ†ãƒ¼ãƒ–ãƒ«æœ¬ä½“ã ã‘ã§ãªãã€é–¢é€£ã™ã‚‹å…¨ã¦ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚‚æ›´æ–°ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ãƒ‡ãƒ¼ã‚¿å¤‰æ›´ãŒå¤šãç™ºç”Ÿã™ã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«ã«å¤šæ•°ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½œæˆã™ã‚‹ã¨ã€ã“ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æ›´æ–°ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰ãŒå¤§ãããªã‚Šã€çµæžœã¨ã—ã¦æ›¸ãè¾¼ã¿æ€§èƒ½ãŒå¤§å¹…ã«ä½Žä¸‹ã—ã¾ã™ã€‚
2. ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸å®¹é‡ã®æ¶ˆè²»:
   ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚‚ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã§ã‚ã‚‹ãŸã‚ã€ãƒ‡ã‚£ã‚¹ã‚¯ä¸Šã«é ˜åŸŸã‚’æ¶ˆè²»ã—ã¾ã™ã€‚å¤šãã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½œæˆã™ã‚‹ã¨ã€å¿…è¦ãªãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ãŒå¢—åŠ ã—ã¾ã™ã€‚
3. ã‚¯ã‚¨ãƒªæœ€é©åŒ–ã®è¤‡é›‘åŒ–:
   ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒå¢—ãˆã™ãŽã‚‹ã¨ã€DBMS ã®ã‚ªãƒ—ãƒ†ã‚£ãƒžã‚¤ã‚¶ãŒæœ€é©ãªå®Ÿè¡Œè¨ˆç”»ã‚’é¸æŠžã™ã‚‹ãŸã‚ã®è€ƒæ…®äº‹é …ãŒå¢—ãˆã€ã‹ãˆã£ã¦æ™‚é–“ãŒã‹ã‹ã£ãŸã‚Šã€éžåŠ¹çŽ‡ãªã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’é¸ã‚“ã§ã—ã¾ã£ãŸã‚Šã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

**ðŸ’¡ å®Ÿå‹™ã§ã¯ã€Œé—‡é›²ã«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’å¢—ã‚„ã•ãšã€EXPLAIN ã§ç¢ºèªã—ã¦æœ¬å½“ã«å¿…è¦ãªã‚‚ã®ã ã‘ã‚’ä½œã‚‹ã€ã“ã¨ãŒéžå¸¸ã«é‡è¦ã§ã™ã€‚**

### **ãã®ä»–ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ç¨®é¡ž**

#### **1. éƒ¨åˆ†ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ (Partial Index)**

ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä¸€éƒ¨ã®è¡Œã«ã®ã¿é©ç”¨ã•ã‚Œã‚‹ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã§ã™ã€‚

**ç‰¹å¾´**:

- ç‰¹å®šã®æ¡ä»¶ã‚’æº€ãŸã™è¡ŒãŒé »ç¹ã«æ¤œç´¢ã•ã‚Œã‚‹å ´åˆã«ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ã‚µã‚¤ã‚ºã‚’å°ã•ãã—ã€æ›´æ–°ã‚³ã‚¹ãƒˆã‚’å‰Šæ¸›ã§ãã¾ã™ã€‚
- ã€Œè«–ç†å‰Šé™¤æ¸ˆã¿ã‚’é™¤ã„ãŸæ¤œç´¢ã€ã‚„ã€Œç‰¹å®šã®ãƒ•ãƒ©ã‚°ãŒ true ã®ã‚‚ã®ã ã‘ã‚’é«˜é€ŸåŒ–ã€ã¨ã„ã£ãŸå®Ÿå‹™ã§é »ç¹ã«ç™ºç”Ÿã™ã‚‹ã‚·ãƒŠãƒªã‚ªã«éžå¸¸ã«æœ‰åŠ¹ã§ã™ã€‚

**ä¾‹**: users ãƒ†ãƒ¼ãƒ–ãƒ«ã§ is_active = true ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿ã‚’å¯¾è±¡ã« email åˆ—ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½œæˆã™ã‚‹ã€‚

```SQL
CREATE INDEX idx_active_users_email ON users (email) WHERE is_active = true;
```

ã“ã‚Œã«ã‚ˆã‚Šã€SELECT \* FROM users WHERE is_active = true AND email = 'test@example.com'ã®ã‚ˆã†ãªã‚¯ã‚¨ãƒªãŒé«˜é€ŸåŒ–ã•ã‚Œã¾ã™ã€‚

#### **2. ãƒ¦ãƒ‹ãƒ¼ã‚¯ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ (Unique Index)**

åˆ—ï¼ˆã¾ãŸã¯åˆ—ã®çµ„ã¿åˆã‚ã›ï¼‰ã«æ ¼ç´ã•ã‚Œã‚‹å€¤ã®é‡è¤‡ã‚’è¨±ã•ãªã„ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã§ã™ã€‚

**ç‰¹å¾´**:

- ãƒ‡ãƒ¼ã‚¿ã®æ•´åˆæ€§ï¼ˆé‡è¤‡ã®ç¦æ­¢ï¼‰ã‚’ä¿è¨¼ã™ã‚‹åˆ¶ç´„ (UNIQUE åˆ¶ç´„) ã¨ã—ã¦æ©Ÿèƒ½ã—ã¾ã™ã€‚
- åŒæ™‚ã«ã€ãã®åˆ—ã§ã®æ¤œç´¢ã‚’é«˜é€ŸåŒ–ã™ã‚‹ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¨ã—ã¦ã‚‚æ©Ÿèƒ½ã—ã¾ã™ã€‚
- ãƒ—ãƒ©ã‚¤ãƒžãƒªã‚­ãƒ¼ï¼ˆPRIMARY KEYï¼‰ã‚‚å†…éƒ¨çš„ã«ã¯ãƒ¦ãƒ‹ãƒ¼ã‚¯ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¨ã—ã¦å®Ÿè£…ã•ã‚Œã‚‹ã“ã¨ãŒã»ã¨ã‚“ã©ã§ã™ã€‚

**ä¾‹**: email åˆ—ã«é‡è¤‡ã‚’è¨±ã•ãªã„ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½œæˆã™ã‚‹ã€‚

```SQL
CREATE UNIQUE INDEX idx_unique_user_email ON users (email);
```

UNIQUE åˆ¶ç´„ã¨ã®é•ã„:
CREATE UNIQUE INDEX ã¯ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½œæˆã™ã‚‹ã¨åŒæ™‚ã«ãƒ¦ãƒ‹ãƒ¼ã‚¯åˆ¶ç´„ã‚’èª²ã—ã¾ã™ã€‚ä¸€æ–¹ã€ALTER TABLE ADD CONSTRAINT UNIQUE (column)ã®ã‚ˆã†ã« UNIQUE åˆ¶ç´„ã‚’æ˜Žç¤ºçš„ã«è¿½åŠ ã—ãŸå ´åˆã‚‚ã€é€šå¸¸ã¯å†…éƒ¨çš„ã«ãƒ¦ãƒ‹ãƒ¼ã‚¯ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒä½œæˆã•ã‚Œã¾ã™ã€‚å®Ÿå‹™ã§ã¯ã€Œé‡è¤‡ã‚’ç¦æ­¢ã™ã‚‹ã€ã¨ã„ã†ç›®çš„ã§ãƒ¦ãƒ‹ãƒ¼ã‚¯ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚„ãƒ¦ãƒ‹ãƒ¼ã‚¯åˆ¶ç´„ãŒä½¿ã‚ã‚Œã‚‹ã“ã¨ãŒå¤šã„ã§ã™ã€‚

## **å®Ÿè¡Œè¨ˆç”» (Execution Plan)**

å®Ÿè¡Œè¨ˆç”»ã¯ã€DBMS ãŒ SQL ã‚¯ã‚¨ãƒªã‚’ã©ã®ã‚ˆã†ã«å®Ÿè¡Œã™ã‚‹ã‹ã‚’ç¤ºã™ã€Œãƒ­ãƒ¼ãƒ‰ãƒžãƒƒãƒ—ã€ã§ã™ã€‚ã“ã‚Œã‚’ç¢ºèªã™ã‚‹ã“ã¨ã§ã€ã©ã®ãƒ†ãƒ¼ãƒ–ãƒ«ãŒã©ã®ã‚ˆã†ã«ã‚¹ã‚­ãƒ£ãƒ³ã•ã‚Œã€ã©ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒä½¿ã‚ã‚Œã€ã©ã®ã‚ˆã†ã«çµåˆã•ã‚Œã€ã©ã®ç¨‹åº¦ã®ã‚³ã‚¹ãƒˆãŒã‹ã‹ã‚‹ã‹ã‚’å…·ä½“çš„ã«æŠŠæ¡ã§ãã¾ã™ã€‚å®Ÿè¡Œè¨ˆç”»ã‚’åˆ†æžã™ã‚‹ã“ã¨ã§ã€ã‚¯ã‚¨ãƒªã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹ãƒœãƒˆãƒ«ãƒãƒƒã‚¯ã‚’ç‰¹å®šã—ã€æ”¹å–„ç­–ï¼ˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®è¿½åŠ ã€ã‚¯ã‚¨ãƒªã®æ›¸ãæ›ãˆãªã©ï¼‰ã‚’æ¤œè¨Žã™ã‚‹ãŸã‚ã®é‡è¦ãªæ‰‹ãŒã‹ã‚Šã¨ãªã‚Šã¾ã™ã€‚

### **EXPLAIN, EXPLAIN ANALYZE**

PostgreSQL ã‚’ä¾‹ã«ã€å®Ÿè¡Œè¨ˆç”»ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã®ä»£è¡¨çš„ãªã‚³ãƒžãƒ³ãƒ‰ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

- **EXPLAIN**:
  - ã‚¯ã‚¨ãƒªã®**æŽ¨å®š**å®Ÿè¡Œè¨ˆç”»ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚
  - å®Ÿéš›ã®ã‚¯ã‚¨ãƒªã¯å®Ÿè¡Œã•ã‚Œãªã„ãŸã‚ã€ãƒ‡ãƒ¼ã‚¿é‡ãŒå¤šã„ãƒ†ãƒ¼ãƒ–ãƒ«ã«å¯¾ã—ã¦ã‚‚å®‰å…¨ã«åˆ©ç”¨ã§ãã¾ã™ã€‚
  - è¨ˆç”»ã®ã€Œ**ã‚³ã‚¹ãƒˆ (Cost)**ã€ã‚’æŽ¨å®šå€¤ã¨ã—ã¦è¡¨ç¤ºã—ã¾ã™ã€‚ã‚³ã‚¹ãƒˆã¯ã€å‡¦ç†æ™‚é–“ã¨ãƒªã‚½ãƒ¼ã‚¹ä½¿ç”¨é‡ï¼ˆç‰¹ã«ãƒ‡ã‚£ã‚¹ã‚¯ I/O ã¨ CPU ã‚µã‚¤ã‚¯ãƒ«ï¼‰ã®æ¦‚ç®—å€¤ã§ã‚ã‚Šã€**æ™‚é–“(ms)ã§ã¯ãªãå˜ä½ãªã—ã®ç›¸å¯¾çš„ãªæ¯”è¼ƒ**ã«ç”¨ã„ã‚‰ã‚Œã¾ã™ã€‚å®Ÿéš›ã®å®Ÿè¡Œæ™‚é–“ã¨ã¯å¤§ããã‚ºãƒ¬ã‚‹ã“ã¨ãŒå¤šã„ãŸã‚ã€ã‚ãã¾ã§å‚è€ƒå€¤ã¨ã—ã¦æ‰ãˆã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
- **EXPLAIN ANALYZE**:
  - å®Ÿéš›ã«ã‚¯ã‚¨ãƒªã‚’**å®Ÿè¡Œ**ã—ã€ãã®çµæžœã«åŸºã¥ã„ã¦å®Ÿè¡Œè¨ˆç”»ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚
  - æŽ¨å®šå€¤ã«åŠ ãˆã¦ã€å®Ÿéš›ã®å®Ÿè¡Œæ™‚é–“ (actual time)ã€å®Ÿéš›ã«å‡¦ç†ã•ã‚ŒãŸè¡Œæ•° (rows)ã€ãƒ«ãƒ¼ãƒ—å›žæ•° (loops) ãªã©ã®è©³ç´°ãªæƒ…å ±ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
  - ã‚ˆã‚Šæ­£ç¢ºãªãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹æƒ…å ±ã‚’å¾—ã‚‰ã‚Œã‚‹ãŸã‚ã€**å®Ÿå‹™ã§ã¯ EXPLAIN ANALYZE ã§å¿…ãšå®Ÿæ¸¬ç¢ºèªã™ã‚‹**ã¨ã„ã†æµã‚ŒãŒæŽ¨å¥¨ã•ã‚Œã¾ã™ã€‚ãŸã ã—ã€ã‚¯ã‚¨ãƒªãŒé•·æ™‚é–“ã‹ã‹ã‚‹å ´åˆã‚„ã€ãƒ‡ãƒ¼ã‚¿å¤‰æ›´ã‚’ä¼´ã†å ´åˆã¯æ³¨æ„ãŒå¿…è¦ã§ã™ã€‚

**åŸºæœ¬æ§‹æ–‡**:

```SQL
EXPLAIN [ANALYZE] [VERBOSE] [COSTS] [BUFFERS] [TIMING] [SUMMARY] SELECT ...;
```

**ä¾‹**: products ãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰ä¾¡æ ¼ãŒ 100 ã‚ˆã‚Šå¤§ãã„å•†å“ã‚’å–å¾—ã™ã‚‹ã‚¯ã‚¨ãƒªã®å®Ÿè¡Œè¨ˆç”»ã‚’è¦‹ã‚‹ã€‚

```SQL
-- æŽ¨å®šå®Ÿè¡Œè¨ˆç”»
EXPLAIN SELECT * FROM products WHERE price > 100;

-- å®Ÿéš›ã®å®Ÿè¡Œè¨ˆç”»ã¨çµ±è¨ˆæƒ…å ±
EXPLAIN ANALYZE SELECT * FROM products WHERE price > 100;
```

**å®Ÿè¡Œè¨ˆç”»ã®å‡ºåŠ›ä¾‹ (PostgreSQL):**

```SQL
-- EXPLAIN SELECT * FROM products WHERE price > 100; ã®å‡ºåŠ›ä¾‹
Seq Scan on products (cost=0.00..15.50 rows=50 width=200)
Filter: (price > 100::numeric)

-- EXPLAIN ANALYZE SELECT * FROM products WHERE price > 100; ã®å‡ºåŠ›ä¾‹
Seq Scan on products (cost=0.00..15.50 rows=50 width=200) (actual time=0.015..0.025 rows=50 loops=1)
Filter: (price > 100::numeric)
Planning Time: 0.088 ms
Execution Time: 0.038 ms
```

**å®Ÿè¡Œè¨ˆç”»ã®èª­ã¿æ–¹**:

- å®Ÿè¡Œè¨ˆç”»ã¯é€šå¸¸ã€**å†…å´ï¼ˆã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãŒæ·±ã„éƒ¨åˆ†ï¼‰ã‹ã‚‰å¤–å´ï¼ˆã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãŒæµ…ã„éƒ¨åˆ†ï¼‰ã¸**ã¨å‡¦ç†ãŒé€²ã¿ã¾ã™ã€‚
- å„è¡Œã¯ã€Œ**ãƒŽãƒ¼ãƒ‰**ã€ã¨å‘¼ã°ã‚Œã€DBMS ãŒè¡Œã†æ“ä½œï¼ˆã‚¹ã‚­ãƒ£ãƒ³ã€ã‚½ãƒ¼ãƒˆã€çµåˆãªã©ï¼‰ã‚’ç¤ºã—ã¾ã™ã€‚
- cost=é–‹å§‹ã‚³ã‚¹ãƒˆ..çµ‚äº†ã‚³ã‚¹ãƒˆ: ã‚¯ã‚¨ãƒªãƒ—ãƒ­ã‚»ãƒƒã‚µãŒãã®ãƒŽãƒ¼ãƒ‰ã‚’é–‹å§‹ã™ã‚‹ã¾ã§ã®ã‚³ã‚¹ãƒˆã¨ã€ãã®ãƒŽãƒ¼ãƒ‰ã®å…¨å‡¦ç†ãŒå®Œäº†ã™ã‚‹ã¾ã§ã®ç·ã‚³ã‚¹ãƒˆã®æŽ¨å®šå€¤ã§ã™ã€‚**ã‚³ã‚¹ãƒˆã¯ãƒ‡ã‚£ã‚¹ã‚¯ I/O ã¨ CPU ã‚³ã‚¹ãƒˆã‚’æŠ½è±¡åŒ–ã—ãŸç›¸å¯¾çš„ãªå˜ä½**ã§ã‚ã‚Šã€å®Ÿéš›ã®æ™‚é–“ã¨ã¯ç•°ãªã‚‹ã“ã¨ãŒå¤šã„ã§ã™ã€‚
- rows: ãã®ãƒŽãƒ¼ãƒ‰ã‹ã‚‰å‡ºåŠ›ã•ã‚Œã‚‹ã¨æŽ¨å®šã•ã‚Œã‚‹è¡Œæ•°ã§ã™ã€‚EXPLAIN ANALYZE ã§ã¯ actual rows ã¨ã—ã¦å®Ÿéš›ã®è¡Œæ•°ã‚‚è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
- width: å‡ºåŠ›ã•ã‚Œã‚‹è¡Œã®æŽ¨å®šãƒã‚¤ãƒˆå¹…ã§ã™ã€‚
- Filter: ç‰¹å®šã®æ¡ä»¶ã§çµžã‚Šè¾¼ã¿ãŒè¡Œã‚ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¤ºã—ã¾ã™ã€‚

### **ãƒ†ãƒ¼ãƒ–ãƒ«ã‚¹ã‚­ãƒ£ãƒ³ / ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚¹ã‚­ãƒ£ãƒ³ã®é•ã„ (ãªãœä½¿ã„åˆ†ã‘ã‚‹ã®ã‹ï¼Ÿ)**

å®Ÿè¡Œè¨ˆç”»ã‚’åˆ†æžã™ã‚‹ä¸Šã§æœ€ã‚‚é‡è¦ãªç‚¹ã® 1 ã¤ãŒã€ãƒ‡ãƒ¼ã‚¿ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ–¹æ³•ã§ã™ã€‚ã“ã‚Œã¯ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã® B-Tree æ§‹é€ ã‚’ç†è§£ã—ã¦ã„ã‚Œã°ã€ã‚ˆã‚Šæ˜Žç¢ºã«ãªã‚Šã¾ã™ã€‚

#### **1. ã‚·ãƒ¼ã‚±ãƒ³ã‚·ãƒ£ãƒ«ã‚¹ã‚­ãƒ£ãƒ³ (Sequential Scan / Table Scan)**

- **èª¬æ˜Ž**: ãƒ†ãƒ¼ãƒ–ãƒ«ã®å…¨è¡Œã‚’ç‰©ç†çš„ãªé †åºã§æœ€åˆã‹ã‚‰æœ€å¾Œã¾ã§èª­ã¿è¾¼ã‚€æ–¹æ³•ã§ã™ã€‚ãƒ‡ã‚£ã‚¹ã‚¯ä¸Šã«ãƒ‡ãƒ¼ã‚¿ãŒé€£ç¶šã—ã¦æ ¼ç´ã•ã‚Œã¦ã„ã‚‹å ´åˆã€é«˜é€Ÿã«èª­ã¿è¾¼ã‚ã¾ã™ã€‚
- **ãªãœè¡Œã‚ã‚Œã‚‹ã®ã‹**:
  - **ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒå­˜åœ¨ã—ãªã„**: æ¤œç´¢æ¡ä»¶ã«ä½¿ãˆã‚‹ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒãã‚‚ãã‚‚ãªã„å ´åˆã€å…¨è¡Œã‚’èª­ã¿è¾¼ã‚€ã—ã‹ã‚ã‚Šã¾ã›ã‚“ã€‚
  - **ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒåˆ©ç”¨ã§ããªã„ãƒ‘ã‚¿ãƒ¼ãƒ³**: å‰è¿°ã®ã€Œãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰å‰æ–¹ä¸€è‡´ä»¥å¤–ã€ã‚„ã€Œé–¢æ•°é©ç”¨ã€ãªã©ã®å ´åˆã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã® B-Tree ã‚’åŠ¹çŽ‡çš„ã«ä½¿ãˆãªã„ãŸã‚ã€ã‚·ãƒ¼ã‚±ãƒ³ã‚·ãƒ£ãƒ«ã‚¹ã‚­ãƒ£ãƒ³ãŒé¸æŠžã•ã‚Œã¾ã™ã€‚
  - **çµžã‚Šè¾¼ã¿åŠ¹æžœãŒä½Žã„**: æ¤œç´¢æ¡ä»¶ã§çµžã‚Šè¾¼ã¾ã‚Œã‚‹è¡Œã®å‰²åˆãŒéžå¸¸ã«é«˜ã„å ´åˆï¼ˆä¾‹: å…¨ä½“ã® 30%ä»¥ä¸Šï¼‰ã¯ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½¿ã†ã‚ˆã‚Šã‚‚ãƒ†ãƒ¼ãƒ–ãƒ«å…¨ä½“ã‚’èª­ã¿è¾¼ã‚€æ–¹ãŒé«˜é€Ÿã¨ DBMS ã®ã‚ªãƒ—ãƒ†ã‚£ãƒžã‚¤ã‚¶ãŒåˆ¤æ–­ã™ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ãªãœãªã‚‰ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚¹ã‚­ãƒ£ãƒ³ã¯ B-Tree ã‚’è¾¿ã‚‹ I/O ã¨ã€å„è¡Œã®ãƒ†ãƒ¼ãƒ–ãƒ«æœ¬ä½“ã¸ã® I/Oï¼ˆãƒ–ãƒƒã‚¯ãƒžãƒ¼ã‚¯ãƒ«ãƒƒã‚¯ã‚¢ãƒƒãƒ—ï¼‰ã®åˆè¨ˆã§ã™ãŒã€å¤šæ•°ã®è¡Œã‚’å–å¾—ã™ã‚‹å ´åˆã¯ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‹ã‚‰å€‹åˆ¥ã«ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ I/O ãŒç©ã¿é‡ãªã‚‹ã‚ˆã‚Šã‚‚ã€ãƒ†ãƒ¼ãƒ–ãƒ«ã®å…¨ãƒ‡ãƒ¼ã‚¿ã‚’é€£ç¶šçš„ã«èª­ã¿è¾¼ã‚€ï¼ˆã‚·ãƒ¼ã‚±ãƒ³ã‚·ãƒ£ãƒ«ãƒªãƒ¼ãƒ‰ï¼‰æ–¹ãŒåŠ¹çŽ‡çš„ã«ãªã‚‹ãŸã‚ã§ã™ã€‚
  - **ãƒ†ãƒ¼ãƒ–ãƒ«ãŒéžå¸¸ã«å°ã•ã„**: ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ‡ãƒ¼ã‚¿é‡ãŒãƒ‡ã‚£ã‚¹ã‚¯ã® 1 ãƒ–ãƒ­ãƒƒã‚¯åˆ†ã—ã‹ãªã„ãªã©éžå¸¸ã«å°ã•ã„å ´åˆã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½¿ã†ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰ã®æ–¹ãŒå¤§ãããªã‚‹ãŸã‚ã€ã‚·ãƒ¼ã‚±ãƒ³ã‚·ãƒ£ãƒ«ã‚¹ã‚­ãƒ£ãƒ³ã®æ–¹ãŒé€Ÿã„ã¨åˆ¤æ–­ã•ã‚Œã¾ã™ã€‚
- **ç‰¹å¾´**: å…¨ã¦ã®ãƒ‡ãƒ¼ã‚¿ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã€çµžã‚Šè¾¼ã¿ãŒå°‘ãªã„ã‚¯ã‚¨ãƒªã‚„é›†è¨ˆã‚¯ã‚¨ãƒªã§ã¯åŠ¹çŽ‡çš„ãªå ´åˆãŒã‚ã‚Šã¾ã™ã€‚ã—ã‹ã—ã€ç‰¹å®šã®å°‘æ•°ã®è¡Œã‚’è¦‹ã¤ã‘ãŸã„å ´åˆã«ã¯éžåŠ¹çŽ‡çš„ã§ã™ã€‚

#### **2. ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚¹ã‚­ãƒ£ãƒ³ (Index Scan)**

- **èª¬æ˜Ž**: ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã® B-Tree æ§‹é€ ã‚’åˆ©ç”¨ã—ã¦ã€å¿…è¦ãªãƒ‡ãƒ¼ã‚¿ãŒæ ¼ç´ã•ã‚Œã¦ã„ã‚‹è¡Œã®ç‰©ç†çš„ãªä½ç½®ã‚’ç‰¹å®šã—ã€ãã®è¡Œã ã‘ã‚’åŠ¹çŽ‡çš„ã«èª­ã¿è¾¼ã‚€æ–¹æ³•ã§ã™ã€‚
- **ãªãœè¡Œã‚ã‚Œã‚‹ã®ã‹**:
  - **ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒå­˜åœ¨ã—ã€åˆ©ç”¨å¯èƒ½**: æ¤œç´¢æ¡ä»¶ã«åˆè‡´ã™ã‚‹ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒå­˜åœ¨ã—ã€ã‹ã¤ãã‚ŒãŒåŠ¹çŽ‡çš„ã«ä½¿ãˆã‚‹å ´åˆï¼ˆä¾‹: ç­‰ä¾¡æ¤œç´¢ã€ç¯„å›²æ¤œç´¢ã€å‰æ–¹ä¸€è‡´ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰ï¼‰ã€‚
  - **çµžã‚Šè¾¼ã¿åŠ¹æžœãŒé«˜ã„**: æ¤œç´¢æ¡ä»¶ã«ã‚ˆã£ã¦çµžã‚Šè¾¼ã¾ã‚Œã‚‹è¡Œã®å‰²åˆãŒä½Žã„å ´åˆï¼ˆä¾‹: æ•°%ç¨‹åº¦ï¼‰ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€B-Tree ã®æŽ¢ç´¢ï¼ˆå°‘é‡ã® I/Oï¼‰ã¨ã€å¿…è¦ãªæ•°è¡Œåˆ†ã®ãƒ†ãƒ¼ãƒ–ãƒ«æœ¬ä½“ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ï¼ˆå°‘é‡ã® I/Oï¼‰ã ã‘ã§æ¸ˆã‚€ãŸã‚ã€ã‚·ãƒ¼ã‚±ãƒ³ã‚·ãƒ£ãƒ«ã‚¹ã‚­ãƒ£ãƒ³ã‚ˆã‚Šã‚‚ã¯ã‚‹ã‹ã«é«˜é€Ÿã«ãªã‚Šã¾ã™ã€‚
- **ç¨®é¡ž**:
  - **ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚ªãƒ³ãƒªãƒ¼ã‚¹ã‚­ãƒ£ãƒ³ (Index Only Scan)**: ã‚«ãƒãƒªãƒ³ã‚°ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒåˆ©ç”¨å¯èƒ½ãªå ´åˆã«ã€ãƒ†ãƒ¼ãƒ–ãƒ«æœ¬ä½“ã«ã‚¢ã‚¯ã‚»ã‚¹ã›ãšã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã® B-Tree ã®ã¿ã§å…¨ã¦ã®æƒ…å ±ã‚’å–å¾—ã—ã¾ã™ã€‚ãƒ‡ã‚£ã‚¹ã‚¯ I/O ãŒã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®èª­ã¿è¾¼ã¿ã ã‘ã§æ¸ˆã‚€ãŸã‚ã€æœ€ã‚‚é«˜é€Ÿãªã‚¢ã‚¯ã‚»ã‚¹æ–¹æ³•ã®ä¸€ã¤ã§ã™ã€‚ãŸã ã—ã€PostgreSQL ã®å ´åˆã¯å‰è¿°ã® VACUUM ã«ã‚ˆã‚‹å¯è¦–åŒ–ã®æ¡ä»¶ã‚’æº€ãŸã™å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
  - **ãƒ“ãƒƒãƒˆãƒžãƒƒãƒ—ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚¹ã‚­ãƒ£ãƒ³ (Bitmap Index Scan)** (PostgreSQL ãªã©): è¤‡æ•°ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’çµ„ã¿åˆã‚ã›ã¦è¤‡é›‘ãª AND/OR æ¡ä»¶ã‚’çµžã‚Šè¾¼ã‚€å ´åˆãªã©ã«åˆ©ç”¨ã•ã‚Œã¾ã™ã€‚å„ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚¹ã‚­ãƒ£ãƒ³ã§å¾—ã‚‰ã‚ŒãŸè¡Œã®ä½ç½®æƒ…å ±ï¼ˆãƒ“ãƒƒãƒˆãƒžãƒƒãƒ—å½¢å¼ï¼‰ã‚’çµåˆã—ã€æœ€çµ‚çš„ãªè¡Œã®ã‚»ãƒƒãƒˆã‚’åŠ¹çŽ‡çš„ã«æ±ºå®šã—ãŸå¾Œã€ã¾ã¨ã‚ã¦ãƒ†ãƒ¼ãƒ–ãƒ«æœ¬ä½“ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€å€‹åˆ¥ã®ãƒ–ãƒƒã‚¯ãƒžãƒ¼ã‚¯ãƒ«ãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’æ¸›ã‚‰ã—ã€åŠ¹çŽ‡åŒ–ã‚’å›³ã‚Šã¾ã™ã€‚

è¦‹åˆ†ã‘æ–¹:
å®Ÿè¡Œè¨ˆç”»ã®ãƒŽãƒ¼ãƒ‰åã§ç¢ºèªã§ãã¾ã™ã€‚

- Seq Scan â†’ ã‚·ãƒ¼ã‚±ãƒ³ã‚·ãƒ£ãƒ«ã‚¹ã‚­ãƒ£ãƒ³
- Index Scan â†’ ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚¹ã‚­ãƒ£ãƒ³ (ãƒ†ãƒ¼ãƒ–ãƒ«æœ¬ä½“ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚ã‚Š)
- Index Only Scan â†’ ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚ªãƒ³ãƒªãƒ¼ã‚¹ã‚­ãƒ£ãƒ³ (ãƒ†ãƒ¼ãƒ–ãƒ«æœ¬ä½“ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ãªã—)
- Bitmap Index Scan + Bitmap Heap Scan â†’ ãƒ“ãƒƒãƒˆãƒžãƒƒãƒ—ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚¹ã‚­ãƒ£ãƒ³ (ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‹ã‚‰ãƒ“ãƒƒãƒˆãƒžãƒƒãƒ—ã‚’ä½œã‚Šã€ãã‚Œã‚’ä½¿ã£ã¦ã¾ã¨ã‚ã¦ãƒ†ãƒ¼ãƒ–ãƒ«ã«ã‚¢ã‚¯ã‚»ã‚¹)

### **JOIN æ–¹å¼ (ãªãœã“ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’é¸ã¶ã®ã‹ï¼Ÿ)**

è¤‡æ•°ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’çµåˆã™ã‚‹éš›ã€DBMS ã¯ã„ãã¤ã‹ã®ç•°ãªã‚‹ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ï¼ˆçµåˆæ–¹å¼ï¼‰ã‚’ä½¿ã„åˆ†ã‘ã¾ã™ã€‚ã©ã®çµåˆæ–¹å¼ãŒé¸æŠžã•ã‚Œã‚‹ã‹ã¯ã€ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚µã‚¤ã‚ºã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®æœ‰ç„¡ã€çµåˆæ¡ä»¶ã€ãƒ‡ãƒ¼ã‚¿åˆ†æ•£ãªã©ã«ã‚ˆã£ã¦ DBMS ã®ã‚ªãƒ—ãƒ†ã‚£ãƒžã‚¤ã‚¶ãŒåˆ¤æ–­ã—ã¾ã™ã€‚å„æ–¹å¼ã¯ã€ç‰¹å®šã®ã‚·ãƒŠãƒªã‚ªã§æœ€é©ãªãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹ã‚’ç™ºæ®ã—ã¾ã™ã€‚

#### **1. ãƒã‚¹ãƒ†ãƒƒãƒ‰ãƒ«ãƒ¼ãƒ—çµåˆ (Nested Loop Join)**

- **èª¬æ˜Ž**: ä¸€æ–¹ã®ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆå¤–éƒ¨ãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰ã®è¡Œã‚’ 1 ã¤ãšã¤å–ã‚Šå‡ºã—ã€ãã®è¡Œã«å¯¾ã—ã¦ã‚‚ã†ä¸€æ–¹ã®ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆå†…éƒ¨ãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰ã‚’ãƒ«ãƒ¼ãƒ—ã—ã¦çµåˆæ¡ä»¶ã«ä¸€è‡´ã™ã‚‹è¡Œã‚’æŽ¢ã™æ–¹æ³•ã§ã™ã€‚
- **ãªãœé¸æŠžã•ã‚Œã‚‹ã®ã‹**:
  - **å¤–éƒ¨ãƒ†ãƒ¼ãƒ–ãƒ«ã®è¡Œæ•°ãŒå°‘ãªã„**: å¤–éƒ¨ãƒ†ãƒ¼ãƒ–ãƒ«ã®è¡ŒãŒå°‘ãªã„å ´åˆã€å†…éƒ¨ãƒ†ãƒ¼ãƒ–ãƒ«ã¸ã®æ¤œç´¢å›žæ•°ãŒå°‘ãªãæ¸ˆã‚€ãŸã‚åŠ¹çŽ‡çš„ã§ã™ã€‚
  - **å†…éƒ¨ãƒ†ãƒ¼ãƒ–ãƒ«ã«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹**: å†…éƒ¨ãƒ†ãƒ¼ãƒ–ãƒ«ã®çµåˆåˆ—ã«åŠ¹çŽ‡çš„ãªã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼ˆB-Treeï¼‰ãŒå­˜åœ¨ã™ã‚‹å ´åˆã«éžå¸¸ã«é«˜é€Ÿã§ã™ã€‚å¤–éƒ¨ãƒ†ãƒ¼ãƒ–ãƒ«ã®å„è¡Œã‹ã‚‰å–å¾—ã—ãŸçµåˆã‚­ãƒ¼ã§ã€å†…éƒ¨ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’åŠ¹çŽ‡çš„ã«ã‚¹ã‚­ãƒ£ãƒ³ã—ã¦å¯¾å¿œã™ã‚‹è¡Œã‚’è¦‹ã¤ã‘ã‚‰ã‚Œã‚‹ãŸã‚ã€O(NlogM)ã®ã‚ˆã†ãªæ™‚é–“è¨ˆç®—é‡ï¼ˆN ã¯å¤–éƒ¨ãƒ†ãƒ¼ãƒ–ãƒ«ã®è¡Œæ•°ã€M ã¯å†…éƒ¨ãƒ†ãƒ¼ãƒ–ãƒ«ã®è¡Œæ•°ï¼‰ã«ãªã‚Šã¾ã™ã€‚
  - **æ¯”è¼ƒçš„å°è¦æ¨¡ãªçµåˆ**: æœ€ã‚‚åŸºæœ¬çš„ãªçµåˆæ–¹å¼ã§ã‚ã‚Šã€æ¯”è¼ƒçš„å°è¦æ¨¡ãªçµåˆã‚„ã€çµžã‚Šè¾¼ã¿å¾Œã®çµåˆã§é »ç¹ã«åˆ©ç”¨ã•ã‚Œã¾ã™ã€‚
- **ã‚¤ãƒ¡ãƒ¼ã‚¸**:
  FOR each row in å¤–éƒ¨ãƒ†ãƒ¼ãƒ–ãƒ« DO -- (å¤–éƒ¨ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ 1 è¡Œãšã¤èª­ã¿è¾¼ã‚€)
  FOR each row in å†…éƒ¨ãƒ†ãƒ¼ãƒ–ãƒ« WHERE çµåˆæ¡ä»¶ DO -- (å†…éƒ¨ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æ¤œç´¢ã€‚ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒã‚ã‚Œã°é«˜é€Ÿ)
  å‡ºåŠ›;
  END FOR;
  END FOR;

#### **2. ãƒãƒƒã‚·ãƒ¥çµåˆ (Hash Join)**

- **èª¬æ˜Ž**: ã¾ãšã€å°ã•ã„æ–¹ã®ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆãƒ“ãƒ«ãƒ‰å´ï¼‰ã®çµåˆåˆ—ã®å€¤ã‚’ãƒãƒƒã‚·ãƒ¥é–¢æ•°ã§å¤‰æ›ã—ã€ãƒ¡ãƒ¢ãƒªä¸Šã«ãƒãƒƒã‚·ãƒ¥ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚æ¬¡ã«ã€å¤§ãã„æ–¹ã®ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆãƒ—ãƒ­ãƒ¼ãƒ–å´ï¼‰ã®çµåˆåˆ—ã®å€¤ã‚’åŒã˜ãƒãƒƒã‚·ãƒ¥é–¢æ•°ã§å¤‰æ›ã—ã€ãƒãƒƒã‚·ãƒ¥ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ãƒ—ãƒ­ãƒ¼ãƒ–ï¼ˆæ¤œç´¢ï¼‰ã—ã¦ä¸€è‡´ã™ã‚‹è¡Œã‚’æŽ¢ã—ã¾ã™ã€‚
- **ãªãœé¸æŠžã•ã‚Œã‚‹ã®ã‹**:
  - **çµåˆã™ã‚‹ä¸¡æ–¹ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒãªãã¦ã‚‚é«˜é€Ÿ**: å¤§è¦æ¨¡ãªãƒ†ãƒ¼ãƒ–ãƒ«é–“ã®çµåˆã§ã€çµåˆåˆ—ã«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒãªãã¦ã‚‚é«˜é€Ÿãªå‡¦ç†ãŒå¯èƒ½ã§ã™ã€‚ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒå­˜åœ¨ã—ãªã„å ´åˆã‚„ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚¹ã‚­ãƒ£ãƒ³ã§ã¯åŠ¹çŽ‡ãŒæ‚ªã„ã¨åˆ¤æ–­ã•ã‚Œã‚‹å ´åˆã«å¼·åŠ›ãªé¸æŠžè‚¢ã¨ãªã‚Šã¾ã™ã€‚
  - **ç­‰ä¾¡æ¡ä»¶ (=) ã®çµåˆ**: ç‰¹ã«ã€çµåˆåˆ—ãŒç­‰ä¾¡æ¡ä»¶ï¼ˆ=ï¼‰ã§ã‚ã‚‹å ´åˆã«åŠ¹æžœçš„ã§ã™ã€‚ãƒãƒƒã‚·ãƒ¥é–¢æ•°ã®æ€§è³ªä¸Šã€ç­‰ä¾¡æ¯”è¼ƒã«æœ€é©åŒ–ã•ã‚Œã¦ã„ã¾ã™ã€‚
  - **å¤§è¦æ¨¡ãªçµåˆ**: ãƒ“ãƒ«ãƒ‰å´ã®ãƒ†ãƒ¼ãƒ–ãƒ«ãŒãƒ¡ãƒ¢ãƒªã«åŽã¾ã‚‹ç¨‹åº¦ã§ã‚ã‚Œã°ã€O(N+M)ã«è¿‘ã„æ™‚é–“è¨ˆç®—é‡ã§å‡¦ç†ã§ãã‚‹ãŸã‚ã€éžå¸¸ã«åŠ¹çŽ‡çš„ã§ã™ã€‚
  - **ãƒ¡ãƒ¢ãƒªæ¶ˆè²»**: ãƒ¡ãƒ¢ãƒªã‚’å¤šãæ¶ˆè²»ã™ã‚‹ãŸã‚ã€ãƒ“ãƒ«ãƒ‰å´ã®ãƒ†ãƒ¼ãƒ–ãƒ«ãŒéžå¸¸ã«å¤§ãã„å ´åˆã¯ãƒãƒƒã‚·ãƒ¥ãƒ†ãƒ¼ãƒ–ãƒ«ãŒãƒ¡ãƒ¢ãƒªã«åŽã¾ã‚‰ãšã€ãƒ‡ã‚£ã‚¹ã‚¯ã¸ã®æ›¸ãå‡ºã—ï¼ˆãƒãƒƒã‚·ãƒ¥ãƒã‚±ãƒƒãƒˆã®ã‚¹ãƒ”ãƒ«ï¼‰ãŒç™ºç”Ÿã—ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹ãŒä½Žä¸‹ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
- **ã‚¤ãƒ¡ãƒ¼ã‚¸**:
  1. **ãƒ“ãƒ«ãƒ‰ãƒ•ã‚§ãƒ¼ã‚º**: å°ã•ã„æ–¹ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã®çµåˆåˆ—ã‹ã‚‰ãƒãƒƒã‚·ãƒ¥ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æ§‹ç¯‰ã€‚
  2. **ãƒ—ãƒ­ãƒ¼ãƒ–ãƒ•ã‚§ãƒ¼ã‚º**: å¤§ãã„æ–¹ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã®çµåˆåˆ—ã‚’ãƒãƒƒã‚·ãƒ¥ãƒ†ãƒ¼ãƒ–ãƒ«ã§æ¤œç´¢ã€‚

#### **3. ãƒžãƒ¼ã‚¸çµåˆ (Merge Join)**

- **èª¬æ˜Ž**: çµåˆã™ã‚‹ä¸¡æ–¹ã®ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆã¾ãŸã¯ä¸­é–“çµæžœï¼‰ã‚’ã€çµåˆåˆ—ã§ã‚½ãƒ¼ãƒˆã—ã¾ã™ã€‚ãã®å¾Œã€ã‚½ãƒ¼ãƒˆã•ã‚ŒãŸ 2 ã¤ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å…ˆé ­ã‹ã‚‰é †ã«ã‚¹ã‚­ãƒ£ãƒ³ã—ã¦ã„ãã€çµåˆæ¡ä»¶ã«ä¸€è‡´ã™ã‚‹è¡Œã‚’ãƒžãƒ¼ã‚¸ï¼ˆçµåˆï¼‰ã—ã¾ã™ã€‚
- **ãªãœé¸æŠžã•ã‚Œã‚‹ã®ã‹**:
  - **çµåˆåˆ—ãŒæ—¢ã«ã‚½ãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹**: çµåˆåˆ—ã«æ—¢ã«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒã‚ã‚Šã€ãã‚ŒãŒã‚½ãƒ¼ãƒˆé †ã«ãªã£ã¦ã„ã‚‹å ´åˆï¼ˆä¾‹: ãƒ—ãƒ©ã‚¤ãƒžãƒªã‚­ãƒ¼ã‚„ B-Tree ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’æŒã¤åˆ—ï¼‰ã‚„ã€ä¸¡æ–¹ã®ãƒ†ãƒ¼ãƒ–ãƒ«ãŒçµåˆåˆ—ã§ã‚½ãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹å ´åˆã«éžå¸¸ã«é«˜é€Ÿã§ã™ã€‚ã‚½ãƒ¼ãƒˆã«ã‹ã‹ã‚‹ã‚³ã‚¹ãƒˆãŒä¸è¦ã«ãªã‚‹ãŸã‚ã€O(N+M)ã®æ™‚é–“è¨ˆç®—é‡ã§å‡¦ç†ã§ãã¾ã™ã€‚
  - **ã‚½ãƒ¼ãƒˆã•ã‚Œã¦ã„ãªã„å ´åˆã®ã‚³ã‚¹ãƒˆ**: ã‚½ãƒ¼ãƒˆã•ã‚Œã¦ã„ãªã„ãƒ†ãƒ¼ãƒ–ãƒ«ã«å¯¾ã—ã¦ã¯ã€æœ€åˆã«ã‚½ãƒ¼ãƒˆå‡¦ç†ï¼ˆI/O ã¨ CPU ã‚’æ¶ˆè²»ï¼‰ãŒç™ºç”Ÿã™ã‚‹ãŸã‚ã€ãã®ã‚³ã‚¹ãƒˆãŒè¿½åŠ ã•ã‚Œã¾ã™ã€‚ã“ã®ã‚½ãƒ¼ãƒˆå‡¦ç†ãŒå¤§ããªãƒœãƒˆãƒ«ãƒãƒƒã‚¯ã«ãªã‚‹ã“ã¨ã‚‚ã‚ã‚Šã¾ã™ã€‚
  - **ç¯„å›²æ¡ä»¶ (>, <, BETWEEN) ã«ã‚ˆã‚‹çµåˆ**: ãƒã‚¹ãƒ†ãƒƒãƒ‰ãƒ«ãƒ¼ãƒ—çµåˆã‚„ãƒãƒƒã‚·ãƒ¥çµåˆã«æ¯”ã¹ã¦ã€ç¯„å›²æ¡ä»¶ã«ã‚ˆã‚‹çµåˆã§ã‚‚åˆ©ç”¨å¯èƒ½ã§ã™ã€‚
- **ã‚¤ãƒ¡ãƒ¼ã‚¸**:
  1. **ã‚½ãƒ¼ãƒˆãƒ•ã‚§ãƒ¼ã‚º**: ä¸¡ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’çµåˆåˆ—ã§ã‚½ãƒ¼ãƒˆï¼ˆå¿…è¦ã§ã‚ã‚Œã°ï¼‰ã€‚
  2. **ãƒžãƒ¼ã‚¸ãƒ•ã‚§ãƒ¼ã‚º**: ã‚½ãƒ¼ãƒˆæ¸ˆã¿ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’åŒæ™‚ã«ã‚¹ã‚­ãƒ£ãƒ³ã—ã€ä¸€è‡´ã™ã‚‹è¡Œã‚’çµåˆã€‚

çµåˆæ–¹å¼ã®è¦‹åˆ†ã‘æ–¹:
å®Ÿè¡Œè¨ˆç”»ã®ãƒŽãƒ¼ãƒ‰åã§ç¢ºèªã§ãã¾ã™ã€‚

- Nested Loop â†’ ãƒã‚¹ãƒ†ãƒƒãƒ‰ãƒ«ãƒ¼ãƒ—çµåˆ
- Hash Join â†’ ãƒãƒƒã‚·ãƒ¥çµåˆ
- Merge Join â†’ ãƒžãƒ¼ã‚¸çµåˆ

## **å®Ÿå‹™ã§å½¹ç«‹ã¤ãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼**

é…ã„ã‚¯ã‚¨ãƒªã«å‡ºä¼šã£ãŸéš›ã«ã€ã©ã®ã‚ˆã†ã«ãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹ã‚’æ”¹å–„ã—ã¦ã„ãã‹ã®ä¸€èˆ¬çš„ãªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’ã¾ã¨ã‚ã¾ã™ã€‚

1. **é…ã„ã‚¯ã‚¨ãƒªã®ç‰¹å®š**:
   - ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ­ã‚°ã‚„ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ç›£è¦–ãƒ„ãƒ¼ãƒ«ãªã©ã‹ã‚‰ã€å®Ÿè¡Œæ™‚é–“ã®é•·ã„ã‚¯ã‚¨ãƒªã‚’ç‰¹å®šã—ã¾ã™ã€‚
2. **EXPLAIN ANALYZE ã§å®Ÿè¡Œè¨ˆç”»ã®ç¢ºèª**:
   - ç‰¹å®šã—ãŸã‚¯ã‚¨ãƒªã«å¯¾ã—ã¦ EXPLAIN ANALYZE ã‚’å®Ÿè¡Œã—ã€å®Ÿéš›ã®å®Ÿè¡Œè¨ˆç”»ã¨çµ±è¨ˆæƒ…å ±ã‚’å–å¾—ã—ã¾ã™ã€‚
   - ã“ã®éš›ã€EXPLAIN ã§æŽ¨å®šã‚³ã‚¹ãƒˆã ã‘ã‚’è¦‹ã‚‹ã®ã§ã¯ãªãã€**å¿…ãš ANALYZE ã‚’ä½¿ã£ã¦å®Ÿéš›ã®æ™‚é–“ã‚„è¡Œæ•°ã‚’ç¢ºèªã™ã‚‹**ã“ã¨ãŒé‡è¦ã§ã™ã€‚
3. **å®Ÿè¡Œè¨ˆç”»ã®åˆ†æž**:
   - **ãƒ†ãƒ¼ãƒ–ãƒ«ã‚¹ã‚­ãƒ£ãƒ³ãŒé »ç¹ã«ç™ºç”Ÿã—ã¦ã„ãªã„ã‹**: ç‰¹ã«ã€å°‘æ•°ã®è¡Œã‚’çµžã‚Šè¾¼ã¿ãŸã„å ´é¢ã§ Seq Scan ãŒå‡ºã¦ã„ã‚‹å ´åˆã¯ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®æ¤œè¨ŽãŒå¿…è¦ã§ã™ã€‚
   - **ã‚³ã‚¹ãƒˆã®é«˜ã„ãƒŽãƒ¼ãƒ‰ï¼ˆãƒœãƒˆãƒ«ãƒãƒƒã‚¯ï¼‰ã‚’ç‰¹å®š**: actual time ãŒé•·ãã‹ã‹ã£ã¦ã„ã‚‹ãƒŽãƒ¼ãƒ‰ã‚„ã€rows ã®æŽ¨å®šå€¤ã¨å®Ÿæ¸¬å€¤ãŒå¤§ããä¹–é›¢ã—ã¦ã„ã‚‹ãƒŽãƒ¼ãƒ‰ã«æ³¨ç›®ã—ã¾ã™ã€‚
   - **ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®åˆ©ç”¨çŠ¶æ³**: æ„å›³ã—ãŸã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒä½¿ã‚ã‚Œã¦ã„ã‚‹ã‹ã€Index Only Scan ãŒåˆ©ç”¨ã•ã‚Œã¦ã„ã‚‹ã‹ã‚’ç¢ºèªã—ã¾ã™ã€‚
   - **JOIN æ–¹å¼ã®ç¢ºèª**: å¤§è¦æ¨¡ãªãƒ†ãƒ¼ãƒ–ãƒ«çµåˆã§éžåŠ¹çŽ‡ãª Nested Loop ãŒé¸ã°ã‚Œã¦ã„ãªã„ã‹ãªã©ã‚’ç¢ºèªã—ã¾ã™ã€‚
4. **æ”¹å–„ç­–ã®æ¤œè¨Žã¨å®Ÿæ–½**:
   - **ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®è¿½åŠ ãƒ»ä¿®æ­£**:
     - æ¤œç´¢æ¡ä»¶ï¼ˆWHERE å¥ï¼‰ã‚„ã‚½ãƒ¼ãƒˆæ¡ä»¶ï¼ˆORDER BY å¥ï¼‰ã«ä½¿ã‚ã‚Œã¦ã„ã‚‹åˆ—ã«ã€é©åˆ‡ãªå˜ä¸€åˆ—ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚„è¤‡åˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½œæˆã—ã¾ã™ã€‚
     - SELECT å¥ã«å«ã¾ã‚Œã‚‹åˆ—ãŒå¤šã„å ´åˆã¯ã€ã‚«ãƒãƒªãƒ³ã‚°ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼ˆINCLUDE å¥ï¼‰ã‚’æ¤œè¨Žã—ã¾ã™ã€‚
     - ç‰¹å®šã®æ¡ä»¶ã§çµžã‚Šè¾¼ã¾ã‚Œã‚‹è¡ŒãŒå¤šã„å ´åˆã¯ã€éƒ¨åˆ†ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’æ¤œè¨Žã—ã¾ã™ã€‚
     - LIKE '%...'ã®ã‚ˆã†ã«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒåŠ¹ã‹ãªã„ãƒ‘ã‚¿ãƒ¼ãƒ³ã«ãªã£ã¦ã„ãªã„ã‹ç¢ºèªã—ã€å¯èƒ½ã§ã‚ã‚Œã°ã‚¯ã‚¨ãƒªã‚’æ›¸ãæ›ãˆã‚‹ã‹ã€é–¢æ•°ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚„æ¼”ç®—å­ã‚¯ãƒ©ã‚¹ã®æŒ‡å®šã‚’æ¤œè¨Žã—ã¾ã™ã€‚
   - **ã‚¯ã‚¨ãƒªã®æ›¸ãæ›ãˆ**:
     - ã‚µãƒ–ã‚¯ã‚¨ãƒªã‚’ã‚ˆã‚ŠåŠ¹çŽ‡çš„ãª JOIN ã‚„**ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦é–¢æ•°**ã«æ›¸ãæ›ãˆã‚‹ã“ã¨ã‚’æ¤œè¨Žã—ã¾ã™ã€‚
     - ä¸è¦ãª JOIN ã‚„åˆ—ã®å–å¾—ãŒãªã„ã‹ç¢ºèªã—ã¾ã™ã€‚
     - OR æ¡ä»¶ã‚’ UNION ã§æ›¸ãæ›ãˆã‚‹ãªã©ã€ã‚ˆã‚Š DBMS ãŒæœ€é©åŒ–ã—ã‚„ã™ã„å½¢ã«å¤‰æ›´ã—ã¾ã™ã€‚
   - **çµ±è¨ˆæƒ…å ±ã®æ›´æ–°**:
     - ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ‡ãƒ¼ã‚¿ãŒå¤§å¹…ã«å¢—æ¸›ã—ãŸå ´åˆã€ANALYZE ã‚³ãƒžãƒ³ãƒ‰ï¼ˆPostgreSQL ã®å ´åˆï¼‰ã§çµ±è¨ˆæƒ…å ±ã‚’æ›´æ–°ã™ã‚‹ã¨ã€DBMS ãŒã‚ˆã‚Šæ­£ç¢ºãªå®Ÿè¡Œè¨ˆç”»ã‚’ç«‹ã¦ã‚‰ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚
5. **åŠ¹æžœã®æ¤œè¨¼**:
   - æ”¹å–„ç­–ã‚’å®Ÿæ–½ã—ãŸå¾Œã€å†åº¦ EXPLAIN ANALYZE ã‚’å®Ÿè¡Œã—ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹ãŒå®Ÿéš›ã«å‘ä¸Šã—ãŸã‹ã€å®Ÿè¡Œè¨ˆç”»ãŒæ”¹å–„ã•ã‚ŒãŸã‹ã‚’ç¢ºèªã—ã¾ã™ã€‚

ã“ã®ç¹°ã‚Šè¿”ã—ã«ã‚ˆã£ã¦ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹ã¯æŒç¶šçš„ã«å‘ä¸Šã—ã¦ã„ãã¾ã™ã€‚

## **ã¾ã¨ã‚**

ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¨å®Ÿè¡Œè¨ˆç”»ã¯ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹ã‚’ç†è§£ã—ã€æ”¹å–„ã™ã‚‹ãŸã‚ã®å¼·åŠ›ãªãƒ„ãƒ¼ãƒ«ã§ã™ã€‚

- **ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹**:
  - B-Tree ã¨ã„ã†ã‚½ãƒ¼ãƒˆã•ã‚ŒãŸéšŽå±¤æ§‹é€ ã«ã‚ˆã£ã¦ã€ç‰¹å®šã®ãƒ‡ãƒ¼ã‚¿ã¸ã®é«˜é€Ÿãªã‚¢ã‚¯ã‚»ã‚¹ã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚
  - æ¤œç´¢ã‚„ã‚½ãƒ¼ãƒˆã‚’é«˜é€ŸåŒ–ã™ã‚‹ãŸã‚ã«ã€é©åˆ‡ãªåˆ—ã«é©åˆ‡ãªç¨®é¡žã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼ˆå˜ä¸€åˆ—ã€è¤‡åˆã€ã‚«ãƒãƒªãƒ³ã‚°ã€éƒ¨åˆ†ã€ãƒ¦ãƒ‹ãƒ¼ã‚¯ï¼‰ã‚’ä½œæˆã™ã‚‹ã“ã¨ãŒé‡è¦ã§ã™ã€‚
  - B-Tree ã®ç‰¹æ€§ä¸Šã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒåŠ¹ã‹ãªã„ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆå‰æ–¹ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰ã€é–¢æ•°é©ç”¨ãªã©ï¼‰ãŒã‚ã‚‹ã“ã¨ã‚’ç†è§£ã—ã€ã‚¯ã‚¨ãƒªã®æ›¸ãæ–¹ã‚’å·¥å¤«ã™ã‚‹ã‹ã€é–¢æ•°ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚„æ¼”ç®—å­ã‚¯ãƒ©ã‚¹ãªã©ã®ä»£æ›¿æ‰‹æ®µã‚’æ¤œè¨Žã™ã‚‹ã“ã¨ãŒå¿…è¦ã§ã™ã€‚
  - ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¯æ›´æ–°ã‚³ã‚¹ãƒˆã‚„ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸æ¶ˆè²»ã¨ã„ã£ãŸãƒ‡ãƒ¡ãƒªãƒƒãƒˆã‚‚ã‚ã‚‹ãŸã‚ã€é—‡é›²ã«å¢—ã‚„ã•ãšã€å¿…è¦ã«å¿œã˜ã¦ä½œæˆãƒ»è¦‹ç›´ã™ã“ã¨ãŒè‚è¦ã§ã™ã€‚
- **å®Ÿè¡Œè¨ˆç”»**:
  - EXPLAIN ã‚„ EXPLAIN ANALYZE ã‚’ä½¿ã£ã¦ã€DBMS ãŒã©ã®ã‚ˆã†ã«ã‚¯ã‚¨ãƒªã‚’å®Ÿè¡Œã—ã¦ã„ã‚‹ã‹ã‚’æŠŠæ¡ã—ã¾ã™ã€‚
  - ãƒ†ãƒ¼ãƒ–ãƒ«ã‚¹ã‚­ãƒ£ãƒ³ã¨ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚¹ã‚­ãƒ£ãƒ³ã®é•ã„ã€ãã—ã¦ãƒã‚¹ãƒ†ãƒƒãƒ‰ãƒ«ãƒ¼ãƒ—ã€ãƒãƒƒã‚·ãƒ¥çµåˆã€ãƒžãƒ¼ã‚¸çµåˆã¨ã„ã£ãŸ JOIN æ–¹å¼ã®ç‰¹æ€§ã‚’ã€ãã‚Œãžã‚Œã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãŒã€Œãªãœãã®ã‚ˆã†ã«æ©Ÿèƒ½ã™ã‚‹ã®ã‹ã€ã¨ã„ã†æ ¹æœ¬åŽŸç†ã¨ã¨ã‚‚ã«ç†è§£ã™ã‚‹ã“ã¨ã§ã€ãƒœãƒˆãƒ«ãƒãƒƒã‚¯ã‚’ç‰¹å®šã—ã€ã‚ˆã‚ŠåŠ¹çŽ‡çš„ãªã‚¯ã‚¨ãƒªã‚„ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æˆ¦ç•¥ã‚’ç«‹ã¦ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
