# **HTTP プロトコルとパス**

## **1\. HTTP プロトコルとは**

**HTTP (Hypertext Transfer Protocol)** は、**クライアント**と**サーバー**の間で情報をやり取りするための通信規約です。Web ブラウザだけでなく、モバイルアプリ、API クライアント、サーバー間の通信など、様々なクライアントがサーバーと「会話」する際のルールを定めています。

この通信は、クライアントがサーバーに「〜をください」と**リクエスト**を送り、サーバーが「はい、どうぞ」と**レスポンス**を返すという仕組みで成り立っています。

## **2\. HTTP リクエストの構成要素**

HTTP リクエストは、以下の 3 つの主要な部分から構成されます。

1. **リクエスト行 (Request Line)**
2. **ヘッダー (Headers)**
3. **ボディ (Body)**

### **2-1. リクエスト行**

リクエスト行は、リクエストの最初の行にあり、サーバーに対する「要求」そのものを表します。この行は、**メソッド**、**URI**、そして**HTTP バージョン**の 3 つの要素で構成されます。

- **メソッド (Method)**: サーバーに対して「何をしてほしいか」を伝える「動詞」です。
  - GET: データの**取得**。
  - POST: 新しいデータの**作成**。
  - PUT: 既存データの**更新**。
  - DELETE: データの**削除**。
- **URI (Uniform Resource Identifier)**: サーバー上のリソースを一意に識別するための文字列です。URI は、私たちがブラウザで目にする URL（Uniform Resource Locator）の多くを占めます。  
  **URL の全体構造**
  > **スキーム**:\/\/**ホスト名**:**ポート番号**/**パス**?**クエリパラメータ**\#**フラグメント**
  - **スキーム (Scheme)**: https や http など、通信方式を示します。
  - **ホスト名 (Host)**: サーバーの**場所**（ドメイン名や IP アドレス）です。
  - **ドメイン名とは？**
    - コンピューター同士は IP アドレス（例: 192.0.2.1）という数字の羅列で通信します。しかし、人間にとって IP アドレスは覚えにくいため、**ドメイン名**という分かりやすい名前がつけられています（例: example.com）。
    - このドメイン名を IP アドレスに変換する仕組みを**DNS (Domain Name System)** と呼びます。あなたがブラウザでドメイン名を入力すると、裏側で DNS が働き、対応する IP アドレスを調べてからサーバーに接続しています。
  - **ポート番号 (Port)**: サーバーの**入り口**となるポート番号です。通常は省略されます。
  - **パス (Path)**: ホスト名以降の「/」から始まる部分で、サーバー上の**リソースの場所**を示します。
    - <span style="color: red; ">パスパラメータ (Path Parameters)</span>: パスの一部を可変にして、特定のリソースを一意に指定するために使われる変数のようなものです。
      - **例**: /users/123 の 123 の部分。これにより、「ID が 123 のユーザー」という特定のリソースを指定できます。
  - <span style="color: red; "> クエリパラメータ (Query Parameters)</span>: ?以降の key=value の形式で、サーバーに渡す**追加情報**です。
  - **（フラグメント (Fragment)）**: \#以降の部分で、ページ内の特定の位置を示すために使われます（サーバーには送られません）。

### **2-2. ヘッダー (Headers)**

リクエストに関する付加情報（データの形式、認証情報、キャッシュの制御、使用しているブラウザやアプリの情報など）をキーと値のペアで格納します。

### **2-3. ボディ (Body)**

POST や PUT など、サーバーに送信する実際のデータです。GET や DELETE リクエストでは通常は空です。

- <span style="color: red; "> ボディパラメータ (Body Parameters)</span>: リクエストボディに含めて送信されるデータそのものです。JSON 形式が最も一般的で、複雑な構造を持つデータを送信するのに適しています。
  - **例**: ユーザー登録時に、名前やメールアドレスといった複数の情報をまとめて送信する場合。  
    {  
     "name": "山田 太郎",  
     "email": "yamada.taro@example.com",  
     "password": "password123"  
    }

### **2-4. データ形式**

body に詰めたりするデータの形式はいろいろ種類がありますが、今回は json 形式で送ります。一番ポピュラー。

## **3\. HTTP レスポンスの構成要素**

サーバーは、クライアントからのリクエストに対して必ず**レスポンス**を返します。レスポンスもリクエストと同様に、いくつかの重要な要素で構成されます。

- **ステータスコード (Status Code)**: 3 桁の数字で、リクエストが成功したか、失敗したか、どのような状態にあるかを示します。このコードを見ることで、クライアントはサーバーがリクエストをどのように処理したかを即座に判断できます。  
  主なステータスコードの分類は以下の通りです。
  - **2xx (成功)**: リクエストが正常に処理されました。
    - **例**: 200 OK (成功), 201 Created (新規リソースの作成に成功)
  - **3xx (リダイレクト)**: クライアントは別の場所にリクエストを送り直す必要があります。
  - **4xx (クライアントエラー)**: クライアント側のリクエストに問題があります。
    - **例**: 400 Bad Request (リクエスト内容が不正), 404 Not Found (指定されたリソースが見つからない)
  - **5xx (サーバーエラー)**: サーバー側の処理で問題が発生しました。
    - **例**: 500 Internal Server Error (サーバーで予期せぬエラーが発生)
- **ヘッダー (Headers)**: レスポンスに関する付加情報（データの形式、データのサイズ、キャッシュの有効期限など）をキーと値のペアで格納します。
  - **例**: Content-Type: application/json (レスポンスボディが JSON 形式であることを示す), Content-Length: 128 (ボディのバイト数)
- **ボディ (Body)**: クライアントが実際に要求したデータ本体です。
  - Web サイトの場合は HTML、画像ファイルなどのデータが含まれます。
  - Web API の場合は、多くの場合**JSON 形式**のデータが含まれます。

具体例:

```
GET /users/123 のリクエストに対する成功レスポンスの例です。
HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 54

{
 "id": 123,
 "name": "山田 太郎",
 "email": "yamada.taro@example.com"
}
```

## **補足：データ形式**

### csv 形式

```
ID, Name, Country
111, Mike, USA
222, Nancy, Canada

```

- Comma-Separated Values の略
- excel とかで開けるやつ

### json 形式

```
{
    {'ID': '111', 'Name': 'Mike', 'Country': 'USA'},
    {'ID': '222', 'Name': 'Nancy', 'Country': 'Canada'}
}
```

- JavaScript Object Notation の略
- javascript のオブジェクトの書き方
- これを使います

### xml 形式

```
<?xml version='1.0' encoding='utf-8'>
<root>
    <employee>
        <employ>
            <ID>111</ID>
            <Name>Mike</Name>
            <Country>USA</Country>
        </employ>
        <employ>
            <ID>222</ID>
            <Name>Nancy</Name>
            <Country>Canada</Country>
        </employ>
    </employee>
</root>
```

- Extensible Markup Language の略
- html に似ていて，タグでデータを囲み，入れ子構造にすることが可能

## **4\. Web ページのパスと REST API のパスの違い**

### ↑ ここは 3 か月目の内容なので、とりあえず web ページの url と restapi の url は違いますよという話だけ。<br>

どちらもリソースを指しますが、web ページのほうはページの場所を示し、api のほうはサーバーのリソース（情報）を指します。

どちらもサーバー上のアドレスを指定するものですが、その\*\*「目的」**と**「設計思想」\*\*が大きく異なります。

### **(1) Web ページのパス**

Web ページのパスは、主に特定の\*\*ドキュメント（HTML ファイルなど）\*\*をユーザーに表示することを目的としています。ユーザーがウェブサイトの階層構造を理解し、現在地を把握しやすくするために設計されています。

- **設計思想**: **ドキュメント指向**
- **特徴**:
  - ユーザーが理解しやすい階層的な構造になっています。
  - パス自体が、サーバー上のフォルダやファイルの構造と似ていることが多いです。

具体例:  
https://example.com/products/electronics/laptops  
→ ブラウザがサーバーに「products フォルダ内の electronics フォルダにある laptops のページをください」とリクエストしています。

### **(2) REST API のパス**

REST API のパスは、サーバー上の\*\*リソース（データ）\*\*を操作することを目的としています。パスに動詞を含まず、HTTP メソッドと組み合わせることで「データの操作」を表現します。

- **設計思想**: **リソース指向**
- **特徴**:
  - リソースを**名詞**で表現し、HTTP メソッドと組み合わせて操作を定義します。
  - 通常、リソースの集合を表すために**複数形**が使われますが、単数形を使用することもあります（例: /user/123/profile）。
  - **原則として**パスに動詞（get, create など）は含めません。

具体例:  
以下は、/users というパスと HTTP メソッドを組み合わせた例です。

| HTTP メソッド | パス                | 意味                                                                                     |
| :------------ | :------------------ | :--------------------------------------------------------------------------------------- |
| GET           | /users              | 全てのユーザー**データ**を**取得**する                                                   |
| GET           | /users/123          | ID が 123 のユーザー**データ**を**取得**する                                             |
| POST          | /users              | 新しいユーザー**データ**を**作成**する                                                   |
| PUT           | /users/123          | ID が 123 のユーザー**データ**を**更新**する                                             |
| DELETE        | /users/123          | ID が 123 のユーザー**データ**を**削除**する                                             |
| POST          | /users/123/messages | ID が 123 のユーザーの**メッセージ**を**作成**する (ユーザー 123 にメッセージを送るとき) |

#### **補足**

多くの API では、一度に取得するデータ件数を制限（ページング）したり、条件を絞り込んだりするために、クエリパラメータを使用します。  
例: GET /users?limit=10\&offset=20

### **まとめ**

Web ページのパスが「どの**ページ**を見たいか」を示すのに対し、REST API のパスは「どの**データ**を、どう操作したいか」を示します。Web API を学ぶ上で、この\*\*「リソース指向」\*\*の考え方を理解することが非常に重要になります。
